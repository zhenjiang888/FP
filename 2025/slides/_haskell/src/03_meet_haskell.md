# ç¬¬ 03 ç« ï¼šåˆè§ Haskell

## ä½¿ç”¨ Haskell è¯­è¨€å®šä¹‰å‡½æ•°

> åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨ Haskell è¯­è¨€ï¼Œå¯¹ä¸Šä¸€ç« ç»™å‡ºçš„è‹¥å¹²å‡½æ•°ç¤ºä¾‹è¿›è¡Œé‡å®šä¹‰ï¼Œå¹¶ç»“åˆè¿™äº›ç¤ºä¾‹å¯¹ Haskell è¯­è¨€çš„ç›¸å…³ç»†èŠ‚è¿›è¡Œè¯´æ˜ã€‚

### 01 é€»è¾‘éè¿ç®—

#### ç¬¬ 1 ç§å®šä¹‰æ–¹å¼ï¼šæ¨¡å¼åŒ¹é… (Pattern Matching)

```Haskell
not :: Bool -> Bool
not True  = False
not False = True
```
ç›¸å…³ä¿¡æ¯è¯´æ˜ï¼š

- ä½ å¯ä»¥åœ¨ `https://play.haskell.org/` è¿™ä¸ªé¡µé¢å®é™…è¿è¡Œä¸€ä¸‹è¿™ä¸ªç¨‹åº

  > åœ¨ Haskell ç¼ºçœåŠ è½½çš„ä¿¡æ¯ä¸­å·²ç»å­˜åœ¨äº†`not`å‡½æ•°çš„å®šä¹‰ï¼›\
    ä¸ºäº†é¿å…é‡åå¯¼è‡´çš„ç¼–è¯‘é”™è¯¯ï¼Œæœ€ç®€å•çš„è°ƒæ•´æ–¹å¼ï¼šæŠŠå‡½æ•°åæ”¹å˜ä¸€ä¸‹ã€‚

  > å°è¯•åœ¨ `https://play.haskell.org/` ä¸­è¾“å…¥å¦‚ä¸‹ç¨‹åºï¼š
  >  ```haskell
  >  main :: IO ()
  >  main = do
  >    putStrLn $ show $ not' True
  >
  >  not' :: Bool -> Bool
  >  not' True  = False
  >  not' False = True
  >  ```
  > ç„¶åç‚¹å‡» â€œRunâ€ æŒ‰é’®

- `Bool` æ˜¯ä¸€ä¸ªç±»å‹ï¼›å®ƒåŒ…å«ä¸¤ä¸ªå€¼ï¼š`True` `False`

- `not :: Bool -> Bool`ï¼šå£°æ˜`not`çš„ç±»å‹æ˜¯`Bool -> Bool`

  > **å°å’Œå°šï¼š** ä¸ºä»€ä¹ˆä¸ç”¨å•ä¸ªå†’å·`:`ä½œä¸ºç±»å‹å£°æ˜ç¬¦ï¼Ÿ
  >
  > **å”åƒ§ï¼š** åœ¨Haskellä¸­ï¼Œå•å†’å·å¦æœ‰å®ƒåŒï¼›
  > - ç›®å‰çœ‹æ¥ï¼Œâ€œåŒå†’å·ä½œä¸ºç±»å‹å£°æ˜ç¬¦â€ è¿™ä¸ªè®¾è®¡å†³ç­–å¹¶ä¸å¥½

- `not True = False`ï¼šæŠŠ`not True`è¿™ä¸ªè¡¨è¾¾å¼å®šä¹‰ä¸º`False`

- `not False = True`ï¼šæŠŠ`not False`è¿™ä¸ªè¡¨è¾¾å¼å®šä¹‰ä¸º`True`

ä¸Šè¿°ç¨‹åºçš„ä¸€ç§è½»å¾®å˜ä½“ï¼š

  ```Haskell
  not :: Bool -> Bool
  not x  = case x of
      True  -> False
      False -> True
  ```

#### ç¬¬ 2 ç§å®šä¹‰æ–¹å¼ï¼š**æ¡ä»¶è¡¨è¾¾å¼** (Conditional Expression)

```Haskell
not :: Bool -> Bool
not x = if x == True then False else True
```
ç›¸å…³ä¿¡æ¯è¯´æ˜ï¼š

- åœ¨ Haskell ä¸­ï¼Œ`=` å’Œ `==` å…·æœ‰å®Œå…¨ä¸åŒçš„å«ä¹‰

  - `=` è¡¨ç¤º **â€œå®šä¹‰ä¸ºâ€**ï¼Œå³ï¼šå°†å…¶å·¦ä¾§çš„è¡¨è¾¾å¼å®šä¹‰ä¸ºå³ä¾§çš„è¡¨è¾¾å¼

  - `==` æ˜¯ä¸€ä¸ª **é€»è¾‘è¿ç®—ç¬¦**ï¼Œç”¨æ¥è®¡ç®—å·¦å³ä¸¤ä¾§è¡¨è¾¾å¼çš„å€¼æ˜¯å¦ç›¸ç­‰


#### ç¬¬ 3 ç§å®šä¹‰æ–¹å¼ï¼š**Guarded Equations**

```Haskell
not :: Bool -> Bool
not x | x == True  = False
      | x == False = True
```
æˆ–è€…ï¼Œ

```Haskell
not :: Bool -> Bool
not x | x         = False
      | otherwise = True
```

### 02 é€»è¾‘ä¸è¿ç®—

#### ç¬¬ 1 ç§å®šä¹‰æ–¹å¼ï¼šPattern Matching

```Haskell
and :: Bool -> Bool -> Bool
and True  True  = True
and True  False = False
and False True  = False
and False False = False
```
ç›¸å…³ä¿¡æ¯è¯´æ˜ï¼š

- åœ¨ Haskell ä¸­ï¼Œè¿ç®—ç¬¦ `->` æ»¡è¶³å³ç»“åˆå¾‹

  - ä¹Ÿå³ï¼š`Bool -> Bool -> Bool` ç­‰ä»·äº `Bool -> (Bool -> Bool)`

  > **æ€è€ƒï¼š** `(Bool -> Bool) -> Bool` è¿™ä¸ªç±»å‹çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ

#### ç¬¬ 2 ç§å®šä¹‰æ–¹å¼ï¼šPattern Matching + Wildcard

```Haskell
and :: Bool -> Bool -> Bool
and True True	= True
and _     _   	= False
```

- ä¸€ä¸ªå•ç‹¬çš„ä¸‹åˆ’çº¿ `_` æ˜¯ä¸€ä¸ª wildcardï¼Œè¡¨ç¤ºè¿™é‡Œæœ‰ä¸€ä¸ªå€¼ï¼Œä½†æˆ‘ä»¬é€‰æ‹©æ— è§†å®ƒ

> <div class="warning">
>
> **ä½œä¸š 01**
>
> å…³äºé€»è¾‘ä¸ (and) å‡½æ•°ï¼Œä½ è¿˜èƒ½æƒ³åˆ°å…¶ä»–å®šä¹‰æ–¹å¼å—ï¼Ÿ\
> è¯·ç”¨ Haskell è¯­è¨€å†™å‡ºè‡³å°‘å…¶ä»–ä¸‰ç§å®šä¹‰æ–¹å¼ã€‚
>
> </div>

#### æ›´ä¼ ç»Ÿçš„ä¸€ç§å®šä¹‰æ–¹å¼

```Haskell
and :: (Bool, Bool) -> Bool
and (True, True) = True
and (_   , _   ) = False
```

### 03 æ•´æ•°çš„ç®—æœ¯è¿ç®—

#### ç®—æœ¯è¿ç®—ç¬¦

åœ¨ä¹¦å†™ç®—æœ¯è¿ç®—æ—¶ï¼Œé€šå¸¸ä¸ä¼šé‡‡ç”¨å‡½æ•°çš„å½¢å¼è¿›è¡Œä¹¦å†™ï¼Œè€Œæ˜¯é‡‡ç”¨æ›´ä¸ºç›´è§‚çš„**ç®—æœ¯è¿ç®—ç¬¦** (Operator)

- ä¾‹å¦‚ï¼Œä¸€èˆ¬ä¸ä¼šä¹¦å†™ `plus a b`ï¼Œè€Œæ˜¯å†™ä¸º `a + b`


Haskell æä¾›äº†å¸¸ç”¨çš„ç®—æœ¯è¿ç®—ç¬¦ï¼š

- `+` åŠ æ³•è¿ç®—ï¼›`-` å‡æ³•è¿ç®—ï¼›`*` ä¹˜æ³•è¿ç®—ï¼›`^` æŒ‡æ•°è¿ç®—


**äºŒå…ƒè¿ç®—ç¬¦çš„å‡½æ•°åŒ–**

å¯¹äºä¸¤ä¸ªæ•´æ•° `x` `y`ï¼š

- `x + y` === `(+) x y`

- ä¹Ÿå³ï¼Œ`(+)`æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå…¶ç±»å‹ä¸º `Integer -> Integer -> Integer`

- `Integer` æ˜¯ Haskell æä¾›çš„ä¸€ç§æ•´æ•°ç±»å‹ï¼Œå¯ä»¥è¡¨ç¤ºä»»æ„æ•´æ•°å€¼

åœ¨æ­¤åŸºç¡€ä¸Šï¼ŒHaskellè¿˜æä¾›äº†ä¸€ç§å¢å¼ºè¯­æ³•

- `(x +) y` === `x + y`

- `(+ y) x` === `x + y`

**å‡½æ•°çš„è¿ç®—ç¬¦åŒ–**

å¯¹äºä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿå¯ä»¥å°†å…¶è½¬æ¢ä¸ºå¯¹åº”çš„è¿ç®—ç¬¦ï¼š

- ä¾‹å¦‚ï¼Œ`div x y` === `x`&#96;div&#96;`y`

**æ•´æ•°çš„é™¤è¿ç®—**

- å¦‚æœä½ éœ€è¦çš„æ˜¯æ•´é™¤è¿ç®—ï¼Œä½¿ç”¨å‡½æ•° `div`

- å¦‚æœä½ éœ€è¦çš„æ˜¯å¸¦æœ‰å°æ•°çš„é™¤è¿ç®—ï¼Œä½¿ç”¨è¿ç®—ç¬¦ `/`


> <div class="warning">
>
> **ä½œä¸š 02**
>
> è¯·ç”¨ç›®å‰ä»‹ç»çš„ Haskell è¯­è¨€çŸ¥è¯†ï¼Œç»™å‡ºå‡½æ•°`div`çš„ä¸€ç§æˆ–å¤šç§å®šä¹‰ã€‚
> - div :: Integer -> Integer -> Integer
>
> è¯´æ˜ï¼š
>
> - ä¸ç”¨å…³æ³¨æ•ˆç‡
>
> - ä¸ç”¨å…³æ³¨ç¬¬äºŒä¸ªå‚æ•°ä¸º 0 çš„æƒ…å†µ
>
> - å¦‚æœä½ è®¤ä¸ºè¿™ä¸ªé—®é¢˜æ— è§£æˆ–å¾ˆéš¾ï¼Œè¯·ç»™å‡ºå¿…è¦çš„è¯´æ˜
>   - ä¸ºä»€ä¹ˆæ— è§£ï¼Ÿ æˆ–è€…ï¼Œå›°éš¾åœ¨å“ªé‡Œï¼Ÿ
>
> </div>

### 04 è‡ªç„¶æ•°ç›¸å…³çš„å‡½æ•°

#### è‡ªç„¶æ•°ç±»å‹

Haskell æ ‡å‡†åº“çš„æ¨¡å—`Numeric.Natural`ä¸­å®šä¹‰äº†ä¸€ç§è‡ªç„¶æ•°ç±»å‹`Natural`ï¼Œå¯è¡¨ç¤ºä»»æ„è‡ªç„¶æ•°ã€‚\
ä½†è¿™ä¸ªç±»å‹ç¼ºçœæ²¡æœ‰è¢«åŠ è½½åˆ°ç¨‹åºä¸­ã€‚

ä¸ºäº†åœ¨ç¨‹åºä¸­ä½¿ç”¨è¿™ä¸ªç±»å‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç¨‹åºæ–‡ä»¶çš„å¼€å§‹æ·»åŠ å¦‚ä¸‹è¯­å¥ï¼š

```haskell
import Numeric.Natural (Natural)
```
- å«ä¹‰ï¼šæŠŠ`Numeric.Natural`æ¨¡å—ä¸­çš„å…ƒç´ `Natural`å¼•å…¥åˆ°å½“å‰ç¨‹åºæ–‡ä»¶ä¸­

#### é˜¶ä¹˜å‡½æ•°

```haskell
fact :: Natural -> Natural
fact 0 = 1
fact n = n * fact (n - 1)
```
- è¿™æ˜¯ä¸€ä¸ªé‡‡ç”¨ pattern matching è¿›è¡Œå®šä¹‰çš„å‡½æ•°ï¼Œå«ä¹‰å¦‚ä¸‹ï¼š

  - å¯¹äºä¸€ä¸ªè‡ªç„¶æ•°`n`ï¼š
    - å¦‚æœ `n == 0`ï¼Œåˆ™å°† `fact n` å®šä¹‰ä¸º `1`
    - å¦åˆ™ï¼Œå°† `fact n` å®šä¹‰ä¸º `n * fact (n - 1)`

- åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¦‚æœè¦è¯„ä¼°è¡¨è¾¾å¼`fact x`çš„å€¼ï¼Œåˆ™ä¼šæŒ‰ç…§å®šä¹‰ä¸­ç»™å‡ºçš„é¡ºåºè¿›è¡Œæ¨¡å¼åŒ¹é…ã€‚

  å…·ä½“è€Œè¨€ï¼š

  - é¦–å…ˆæ£€æŸ¥`x`æ˜¯å¦å¯ä»¥åŒ¹é…åˆ°`0`ä¸Šï¼šè‹¥åŒ¹é…æˆåŠŸï¼Œåˆ™å°†`fact x`è¯„ä¼°ä¸º`0`ï¼›å¦åˆ™ï¼Œç»§ç»­åŒ¹é…ã€‚

  - ç»§ç»­æ£€æŸ¥`x`æ˜¯å¦å¯ä»¥åŒ¹é…åˆ°é€šé…ç¬¦`n`ä¸Šã€‚\
    å› ä¸ºï¼š`n`æ˜¯é€šé…ç¬¦ï¼Œå¯ä»¥åŒ¹é…åˆ°ä»»ä½•è‡ªç„¶æ•°ä¸Šã€‚\
    æ‰€ä»¥ï¼šè¿™æ¬¡åŒ¹é…ä¸€å®šæˆåŠŸï¼Œä»è€Œå°†`fact x`è¯„ä¼°ä¸º`x * fact (x - 1)`

- åœ¨ Haskell ä¸­ï¼Œå‡½æ•°åº”ç”¨ (Function Application) å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§
  - å› æ­¤ï¼š`x * fact (x - 1)` ç­‰ä»·äº `x * (fact (x - 1))`

> <div class="warning">
>
> **ä½œä¸š 03**
>
> å…³äºé˜¶ä¹˜å‡½æ•°ï¼Œä½ è¿˜èƒ½æƒ³åˆ°å…¶ä»–å®šä¹‰æ–¹å¼å—ï¼Ÿ\
> è¯·åˆ†åˆ«ä½¿ç”¨ â€œguarded equationsâ€ å’Œ â€œconditional expressionâ€ å†™å‡ºé˜¶ä¹˜å‡½æ•°çš„å®šä¹‰ã€‚
>
> </div>


#### è‡ªç„¶æ•°ä¸Šçš„ fold å‡½æ•°

```haskell
fold :: (t -> t) -> t -> Natural -> t
fold h c 0 = c
fold h c n = h (fold h c (n - 1))
```
è¯´æ˜ï¼š

- åœ¨`fold`çš„ç±»å‹ä¸­ï¼Œå°å†™å­—æ¯ `t` è¡¨ç¤ºä¸€ä¸ª **ç±»å‹å˜é‡**ï¼Œ`Natural` è¡¨ç¤ºä¸€ä¸ªå…·ä½“çš„ç±»å‹

> **å°å’Œå°šï¼š**
> - å¦‚ä½•ç¡®å®šå‡½æ•°ç±»å‹å£°æ˜ä¸­å‡ºç°çš„åç§°ï¼Œæ˜¯ä¸€ä¸ªå…·ä½“ç±»å‹ï¼Œè¿˜æ˜¯ä¸€ä¸ªç±»å‹å˜é‡å‘¢ï¼Ÿ
>
> **å”åƒ§ï¼š**
> - å¯¹äºè¯¥é—®é¢˜ï¼ŒHaskell åœ¨è¯­æ³•å±‚æ¬¡ä¸Šç»™å‡ºäº†ä¸€ç§ç®€å•æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆï¼š
>   - å¦‚æœåç§°çš„ é¦–å­—ç¬¦ æ˜¯ å°å†™å­—æ¯ï¼Œåˆ™è¡¨ç¤º **ç±»å‹å˜é‡**
>   - å¦‚æœåç§°çš„ é¦–å­—ç¬¦ æ˜¯ å¤§å†™å­—æ¯ï¼Œåˆ™è¡¨ç¤º **å…·ä½“ç±»å‹**

- è¡¨è¾¾å¼ `h (fold h c (n - 1))` ä¸­å‡ºç°çš„åœ†æ‹¬å·

  ä¸æ˜¯ï¼šä¸»æµç¼–ç¨‹è¯­è¨€ (C/C++/Java/Rust) ä¸­å‡½æ•°è°ƒç”¨æ—¶ç”¨äºä¼ å‚çš„åœ†æ‹¬å·

  è€Œæ˜¯ï¼šç”¨äº **è°ƒæ•´è¿ç®—é¡ºåº** çš„åœ†æ‹¬å·ã€‚

  - å¦‚æœä¸åŠ è¿™äº›æ‹¬å·ï¼Œåˆ™ `h fold h c n - 1` === `((((h fold) h) c) n) - 1`

- åœ¨ Haskell ä¸­ï¼š

  - å‡½æ•°è°ƒç”¨å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§ã€‚å› æ­¤ï¼Œè‚¯å®šæ¯”è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§é«˜

  - å‡½æ•°è°ƒç”¨æ»¡è¶³å·¦ç»“åˆå¾‹ã€‚å› æ­¤ï¼Œ`f g h k` === `((f g) h) k`

- å¦‚æœä½ å¯¹è¿™ç§è°ƒæ•´è¿ç®—é¡ºåºçš„æ‹¬å·å¾ˆåæ„Ÿï¼ŒHaskell æä¾›äº†å¦ä¸€ç§è§£å†³æ–¹æ¡ˆï¼š

  > äºŒå…ƒè¿ç®—ç¬¦: `$`

  - è¯¥è¿ç®—ç¬¦ï¼š**1. å…·æœ‰æœ€ä½ä¼˜å…ˆçº§**ï¼›**2. æ»¡è¶³å³ç»“åˆå¾‹**

  - è¿ç®—æ•ˆæœï¼šæŠŠå·¦ä¾§çš„å‡½æ•° åº”ç”¨åˆ° å³ä¾§çš„å…ƒç´ ä¸Š

  å› æ­¤ï¼Œå¦‚ä¸‹ä¸‰ä¸ªè¡¨è¾¾å¼ç­‰ä»·ï¼š

  ```haskell
  h  (fold h c  (n - 1))
  h $ fold h c  (n - 1)
  h $ fold h c $ n - 1
  ```

#### é˜¶ä¹˜å‡½æ•° (foldç‰ˆæœ¬)

```haskell
fact :: Natural -> Natural
fact = snd . (fold f (0, 1))

fst :: (a, b) -> a
fst (x, _) = x

snd :: (a, b) -> b
snd (_, y) = y

f :: (Natural, Natural) -> (Natural, Natural)
f (m, n) = (m + 1, (m + 1) * n)
```
è¯´æ˜ï¼š

- dotè¿ç®—ç¬¦`.`å®ç° **å‡½æ•°ç»„åˆ** çš„åŠŸèƒ½

  - `f (g x)` === `(f . g) x` === `f . g $ x`

  - `f . g x` === `f . (g x)`

#### æ–æ³¢é‚£å¥‘å‡½æ•° (foldç‰ˆæœ¬)

```haskell
fib :: Natural -> Natural
fib = fst . (fold g (0, 1))

g :: (Natural, Natural) -> (Natural, Natural)
g (m, n) = (n, m + n)
```

### 05 åºåˆ—ç›¸å…³çš„å‡½æ•°

#### Haskell ä¸­çš„åºåˆ—ç±»å‹

å¯¹äºä»»æ„ç±»å‹ `a`ï¼Œå…¶å¯¹åº”çš„åºåˆ—ç±»å‹ï¼Œå¯ä»¥ä¹¦å†™ä¸º `[a]`ã€‚

åºåˆ—å€¼çš„è¡¨ç¤ºæ–¹å¼ (ä»¥`[Natural]`ä¸ºä¾‹)ï¼š

- ç©ºåºåˆ—ï¼š`[]`

- åŒ…å«ä¸€ä¸ªè‡ªç„¶æ•°`1`çš„åºåˆ—ï¼š`[1]` æˆ– `1 : []`
  -  è¿™é‡Œå‡ºç°çš„å•å†’å·`:`æ˜¯ä¸€ä¸ªäºŒå…ƒè¿ç®—ç¬¦

- åŒ…å«ä¸‰ä¸ªè‡ªç„¶æ•°`1` `2` `3`çš„åºåˆ—ï¼š`[1, 2, 3]` æˆ– `1 : 2 : 3 : []`
  - å¯çŸ¥ï¼šäºŒå…ƒè¿ç®—ç¬¦`:`æ»¡è¶³å³ç»“åˆå¾‹

#### åºåˆ—ä¸Šçš„ fold å‡½æ•°

```haskell
foldr :: (a -> b -> b) -> b -> [a] -> b
foldr h c [] = c
foldr h c (x:xs) = h x (foldr h c xs)

foldl :: (b -> a -> b) -> b -> [a] -> b
foldl h c [] = c
foldl h c (x:xs) = foldl h (h c x) xs
```

#### åºåˆ—ä¸Šçš„è‹¥å¹²å‡½æ•°

```haskell
len :: [a] -> Natural
len [] = 0
len (n:ns) = 1 + len ns
```

<table>
<thead><tr>
  <th>åŸå§‹é€’å½’ç‰ˆæœ¬</th>
  <th>foldå‡½æ•°ç‰ˆæœ¬</th>
</tr></thead>
<tbody>

<tr>
  <td>

  ```haskell
  len :: [a] -> Natural
  len [] = 0
  len (n:ns) = 1 + len ns
  ```
  </td>
  <td>

  ```haskell
  len :: [a] -> Natural
  len = foldr h 0 where
      h x n = n + 1
  ```
  </td>
</tr>

<tr>
  <td>

  ```haskell
  concat :: [a] -> [a] -> [a]
  concat [] ns = ns
  concat (m:ms) ns = m : concat ms ns
  ```
  </td>
  <td>

  ```haskell
  concat :: [a] -> [a] -> [a]
  concat xs ys = foldr (:) ys xs
  ```
  </td>
</tr>

<tr>
  <td>

  ```haskell
  filter :: (a -> Bool) -> [a] -> [a]
  filter p [] = []
  filter p (n:ns)
      | p n   =  n : filter p ns
      | otherwise =  filter p ns
  ```
  </td>
  <td>

  ```haskell
  filter :: (a -> Bool) -> [a] -> [a]
  filter p = foldr (k p) [] where
   -- k :: (a -> Bool) -> a -> [a] -> [a]
      k p n ns | p n   = n : ns
               | otherwise = ns
  ```
  </td>
</tr>

<tr>
  <td>

  ```haskell
  rev :: [a] -> [a]
  rev = revm [] where
   -- revm :: [a] -> [a] -> [a]
      revm xs [] = xs
      revm xs (y:ys) = revm (y:xs) ys
  ```
  </td>
  <td>

  ```haskell
  rev :: [a] -> [a]
  rev = foldl (flip (:)) []
  ```
  </td>
</tr>

</tbody>
</table>

### 06 ä¸€ç§å¿«é€Ÿæ’åºç®—æ³•

```haskell
qsort :: [Integer] -> [Integer]
qsort []     = []
qsort (n:ns) = (qsort $ filter (< n) ns) ++ [n] ++ (qsort $ filter (>= n) ns)
```

> **æ€è€ƒï¼š** çŒœä¸€çŒœï¼ŒäºŒå…ƒè¿ç®—ç¬¦ `++` çš„åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿ

Haskellè¿˜æä¾›äº†ä¸€äº›è¯­æ³•æœºåˆ¶ï¼Œå¯ä»¥è®©qsortçš„å®šä¹‰æ›´åŠ ç»“æ„åŒ–ã€‚

#### let ... in ... è¡¨è¾¾å¼

```haskell
qsort :: [Integer] -> [Integer]
qsort [] = []
qsort (n:ns) = let smaller = qsort $ filter (<  n) ns
                   larger  = qsort $ filter (>= n) ns
               in smaller ++ [n] ++ larger
```
- åœ¨ `in` åé¢çš„è¿™ä¸ªè¡¨è¾¾å¼ä¸­ï¼Œå¯ä»¥è®¿é—® `let ... in` ä¹‹é—´å®šä¹‰çš„å˜é‡


#### where å­å¥

```haskell
qsort :: [Integer] -> [Integer]
qsort []     = []
qsort (n:ns) = smaller ++ [n] ++ larger
    where
        smaller = qsort $ filter (<  n) ns
        larger  = qsort $ filter (>= n) ns
```

> **`let-in è¡¨è¾¾å¼` ä¸ `where å­å¥` çš„ åŒºåˆ«ï¼š**
>
> - åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä¸¤è€…æ²¡æœ‰æœ¬è´¨çš„åŒºåˆ«ï¼Œä»…ä»…åæ˜ äº†ä¸åŒçš„è¡¨ç°å½¢å¼
>
> - åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œ`where å­å¥`å®šä¹‰çš„å˜é‡å…·æœ‰æ›´å¤§çš„ä½œç”¨èŒƒå›´
>   ```haskell
>   f x y | cond1 x y = g z
>         | cond2 x y = h z
>         | otherwise = k z
>       where z = p x y
>   ```
>   - åœ¨`where å­å¥`ä¸­å®šä¹‰çš„ä¸€ä¸ªå˜é‡`z`ï¼Œå¯åœ¨ guarded equations çš„ä»»ä½•åœ°æ–¹è®¿é—®
>
>   - `let in è¡¨è¾¾å¼`ä¸å…·æœ‰è¿™æ ·çš„èƒ½åŠ›
>

<br>

> **å”åƒ§ï¼š**
>
> - ä½ çš„æ„Ÿè§‰å¦‚ä½•ï¼Ÿ
>
>   æˆ‘ä»¬ç”¨äº†ä¸€äº›æœä¸‰æš®å››çš„æŠŠæˆ (è§„å®šä¸€äº›è¯­æ³•è§„åˆ™)ï¼Œ\
>   æŠŠå‡½æ•°å¼æ€ç»´çš„å½¢å¼å˜å¾—æ›´å®¹æ˜“ç†è§£äº†ã€‚
>
> **å°å’Œå°šï¼š**
>
> - æˆ‘å†è§‚å¯Ÿä¸€ä¸‹ï¼›
>
>   å¦‚æœä½ ç»§ç»­æè¿™äº›æœä¸‰æš®å››çš„å°æŠŠæˆï¼Œæˆ‘å°±å‡†å¤‡é€€è¯¾äº†ï¼
>

## Haskell ä¸­æ ‡è¯†ç¬¦å’Œè¿ç®—ç¬¦çš„å‘½åè§„åˆ™

### å…ƒç´ å‘½å

åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºç¨‹åºä¸­å®šä¹‰çš„å…ƒç´  **å‘½å**

- æ‰€è°“ â€œå‘½åâ€ï¼Œå°±æ˜¯ç»™ä¸€ä¸ªä¸œè¥¿èµ‹äºˆä¸€ä¸ªå…·æœ‰åŒºåˆ†ä½œç”¨çš„åç§°

- åç§°çš„ä½œç”¨ï¼šå¯ä»¥é€šè¿‡åç§°å¼•ç”¨åˆ°æ‰€æŒ‡å‘çš„é‚£ä¸ªç¨‹åºå…ƒç´ 

Haskell ä¸­çš„åç§°ï¼Œåˆ†ä¸ºä¸¤å¤§ç±»ï¼š

1. **æ ‡è¯†ç¬¦** (Identifier)

2. **è¿ç®—ç¬¦** (Operator Symbol)

### 01 æ ‡è¯†ç¬¦çš„å‘½åè§„åˆ™

1. ç”±ä¸€æˆ–å¤šä¸ªå­—ç¬¦é¡ºåºæ„æˆ

2. é¦–å­—ç¬¦åªèƒ½æ˜¯ä¸€ä¸ªå­—æ¯ (letter)ï¼Œå…·ä½“åŒ…æ‹¬ï¼š
   - ASCII ç¼–ç è¡¨ä¸­çš„æ‰€æœ‰å­—æ¯ (å³ï¼šæ‰€æœ‰è‹±æ–‡å¤§å°å†™å­—æ¯)
   - Unicodeå­—ç¬¦é›†ä¸­çš„æ‰€æœ‰å­—æ¯

3. å…¶ä»–å­—ç¬¦åªèƒ½æ˜¯ `å­—æ¯` / `æ•°å­—` / `è‹±æ–‡ä¸‹åˆ’çº¿` / `è‹±æ–‡å•å¼•å·`

4. ä¸èƒ½ä¸ Haskell çš„ä¿ç•™è¯é‡å
   - `case` `class` `data` `default` `deriving` `do` `else` `foreign` `if` `import` `in` `infix` `infixl` `infixr` `instance` `let` `module` `newtype` `of` `then` `type` `where` `_`

5. æ ¹æ®ç¨‹åºå…ƒç´ çš„ä¸åŒï¼ŒHaskell è¿˜å¯¹æ ‡è¯†ç¬¦çš„é¦–å­—ç¬¦è¿›è¡Œäº†è¿›ä¸€æ­¥çš„é™åˆ¶
   - ä¸€äº›ç¨‹åºå…ƒç´ ï¼Œå…¶ æ ‡è¯†ç¬¦çš„é¦–å­—ç¬¦ åªèƒ½æ˜¯ å¤§å†™å­—æ¯
   - å…¶ä»–ç¨‹åºå…ƒç´ ï¼Œå…¶ æ ‡è¯†ç¬¦çš„é¦–å­—ç¬¦ åªèƒ½æ˜¯ å°å†™å­—æ¯

     > ç›®å‰å·²ç»æ¶‰åŠåˆ°çš„ç¨‹åºå…ƒç´ åŒ…æ‹¬ï¼š
     > - å‡½æ•° / å˜é‡ / ç±»å‹å˜é‡ï¼šåç§°é¦–å­—ç¬¦å¿…é¡»æ˜¯å°å†™å­—æ¯
     >
     > - ç±»å‹ï¼šåç§°é¦–å­—ç¬¦å¿…é¡»æ˜¯å¤§å†™å­—æ¯

### 02 è¿ç®—ç¬¦çš„å‘½åè§„åˆ™

1. ç”±ä¸€æˆ–å¤šä¸ªç¬¦å· (symbol) é¡ºåºæ„æˆï¼Œå…·ä½“åŒ…æ‹¬ï¼š
   - ASCII ç¼–ç è¡¨ä¸­çš„æ‰€æœ‰ç¬¦å·ï¼š`!` `#` `$` `%` `&` `*` `+` `.` `/` `<` `=` `>` `?` `@` `\` `^` `|` `-` `~` `:`
   - Unicode å­—ç¬¦é›†ä¸­çš„å¤§éƒ¨åˆ†ç¬¦å·

2. ä¸èƒ½ä¸Haskellçš„ä¿ç•™è¿ç®—ç¬¦é‡å
   - `..` `:` `::` `=` `\` `|` `<-` `->` `@` `~` `=>`

3. Haskellè¿›ä¸€æ­¥å°†è¿ç®—ç¬¦åˆ†ä¸ºä¸¤ç±»ï¼š(1) ä»¥è‹±æ–‡å†’å·`:`ä¸ºé¦–å­—ç¬¦çš„è¿ç®—ç¬¦ï¼›(2) å…¶ä»–è¿ç®—ç¬¦
   - æ›´å¤šä¿¡æ¯ï¼ŒæŒ‰éœ€è¯´æ˜

## Hello, World!

### 01 Haskell ä¸­çš„ Hello, World!

```haskell
main = do
  putStrLn "Hello, World!"
```
è¯´æ˜ï¼š

- è¿™æ˜¯ä¸€ä¸ªåˆæ³•çš„ Haskell ç¨‹åº (ç¬¦åˆ Haskell è¯­è¨€è§„èŒƒ)

- å®ƒéšè—äº†ä¸€äº›ä»£ç ï¼Œä»¥è‡³äºçœ‹èµ·æ¥æœ‰äº›å¥‡æ€ª

- æ¢å¤è¿™äº›ä»£ç åï¼Œä¼šå¾—åˆ°ä¸€ä¸ªæ›´å®Œæ•´çš„ç¨‹åºï¼š

```haskell
module Main(main) where
import Prelude

main :: IO ()
main = do
  putStrLn "Hello, World!"
```
- `module Main(main) where`ï¼š

  - è¿™ä¸ªæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªæ¨¡å— `Main`
  - è¿™ä¸ªæ¨¡å—å¯¹å¤–è¾“å‡ºäº†ä¸€ä¸ªåç§°ä¸º `main` çš„å…ƒç´ 
  - è¿™ä¸ªæ¨¡å—ä¸­å®šä¹‰çš„å…ƒç´ å‡ºç°åœ¨`where`ä¹‹å

> **Haskell ä¸­çš„æ¨¡å—**
>
> å…³äºæ¨¡å— (Module)ï¼ŒHaskell è¯­è¨€è§„èŒƒä¸­ç»™å‡ºäº†å¦‚ä¸‹ä¿¡æ¯ï¼š
>
> 1. ä¸€ä¸ª Haskell ç¨‹åºç”±ä¸€æˆ–å¤šä¸ªæ¨¡å—æ„æˆï¼Œä¸”æ¯ä¸€ä¸ªæ¨¡å—å®šä¹‰åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­
>
> 2. ä¸€ä¸ª Haskell ç¨‹åºå¿…é¡»åŒ…å«ä¸€ä¸ªåä¸º`Main`çš„æ¨¡å—
>
>    - `main`å…ƒç´ çš„ç±»å‹å¿…é¡»æ˜¯ `IO t`ï¼›å…¶ä¸­ï¼Œéœ€è¦æŠŠ `t` æ›¿æ¢ä¸ºä¸€ä¸ªå…·ä½“çš„ç±»å‹
>
>    - `IO` æ˜¯`Prelude`æ¨¡å—å¯¹å¤–è¾“å‡ºçš„ä¸€ä¸ªå…ƒç´ ï¼Œç”¨äºå°è£… IO è¿ç®—
>
>      - `Prelude`æ¨¡å—å¯¹å¤–è¾“å‡ºçš„æ‰€æœ‰å…ƒç´ éƒ½ä¼šè¢«é»˜è®¤åŠ è½½åˆ°ä»»ä½•ä¸€ä¸ªæ¨¡å—ä¸­
>
>    - ä¸€ä¸ª Haskell ç¨‹åºçš„è¿è¡Œå°±æ˜¯å¯¹`Main`æ¨¡å—ä¸­çš„`main`å…ƒç´ è¿›è¡Œæ±‚å€¼çš„è¿‡ç¨‹ã€‚\
>      è€Œä¸”ï¼Œæœ€ç»ˆè·å¾—çš„å€¼ä¼šè¢«æŠ›å¼ƒã€‚
>
> 3. æ¨¡å—çš„åç§°å¿…é¡»æ»¡è¶³å¦‚ä¸‹ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€
>
>    - ä¸€ä¸ªä»¥å¤§å†™å­—æ¯å¼€å¤´çš„æ ‡è¯†ç¬¦ã€‚
>      - ä¾‹å¦‚ï¼š`MyModule`
>
>    - ä¸¤æˆ–å¤šä¸ªä»¥å¤§å†™å­—æ¯å¼€å¤´çš„æ ‡è¯†ç¬¦ï¼Œé€šè¿‡å­—ç¬¦`.`è¿æ¥åœ¨ä¸€èµ·ã€‚
>      - ä¾‹å¦‚ï¼š`This.Is.Mymodule`
>
> 4. å¦‚æœï¼šä¸€ä¸ªæ¨¡å—åœ¨è®¾è®¡æ—¶å°±å·²ç»ç¡®å®šä¸ä¼šè¢«å…¶ä»–æ¨¡å—æ‰€å¼•ç”¨\
>    é‚£ä¹ˆï¼šè¯¥æ¨¡å—å¯ä»¥æ”¾åœ¨ä»»æ„ä¸€ä¸ªå…·æœ‰åˆæ³•åç§°çš„æ–‡ä»¶ä¸­
>
>    - é€šå¸¸ï¼Œ`Main`æ¨¡å—ä¸ä¼šè¢«å…¶ä»–æ¨¡å—æ‰€å¼•ç”¨\
>      å› æ­¤ï¼Œå¯ä»¥æŠŠ`Main`æ¨¡å—æ”¾åœ¨ä»»æ„ä¸€ä¸ªæ–‡ä»¶ä¸­
>
>    - ä½†æ˜¯ï¼Œå°†`Main`æ¨¡å—æ‰€åœ¨æ–‡ä»¶åè®¾å®šä¸º`Main`ï¼Œä¸å¤±ä¸ºä¸€ä¸ªå¥½é€‰æ‹©
>
> 5. å¦‚æœï¼šä¸€ä¸ªæ¨¡å—å¯èƒ½ä¼šè¢«å…¶ä»–æ¨¡å—æ‰€å¼•ç”¨ï¼Œ\
>    é‚£ä¹ˆï¼šè¯¥æ¨¡å—æ‰€åœ¨çš„æ–‡ä»¶å¿…é¡»æ»¡è¶³å¦‚ä¸‹æ¡ä»¶ï¼š
>
>    - å¦‚æœï¼šæ¨¡å—åæ˜¯ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œé‚£ä¹ˆï¼šæ¨¡å—æ‰€åœ¨æ–‡ä»¶çš„åç§°å¿…é¡»ä¸æ¨¡å—åç›¸åŒ
>
>    - å¦‚æœï¼šæ¨¡å—åæ˜¯å¤šä¸ªæ ‡è¯†ç¬¦é€šè¿‡`.`å­—ç¬¦è¿æ¥åœ¨ä¸€èµ·ï¼Œé‚£ä¹ˆï¼š
>
>      - æ¨¡å—æ‰€åœ¨æ–‡ä»¶çš„åç§°å¿…é¡»ä¸æ¨¡å—åä¸­æœ€åçš„æ ‡è¯†ç¬¦ç›¸åŒ
>        - ä¾‹å¦‚ï¼Œæ¨¡å—`This.Is.Mymodule`\
>          å¿…é¡»æ”¾ç½®åœ¨ä¸€ä¸ªåä¸º`Mymodule`çš„æ–‡ä»¶ä¸­
>          - è¿™é‡Œçš„æ–‡ä»¶åï¼Œä¸åŒ…å«æ–‡ä»¶æ‰©å±•å
>
>      - æ¨¡å—åä¸­å‰é¢çš„æ¯ä¸€ä¸ªæ ‡è¯†ç¬¦åŠå…¶ä¹‹é—´çš„é¡ºåºå…³ç³»ï¼Œ\
>        å¿…é¡»ä¸æ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•åä»¥åŠç›®å½•ä¹‹é—´çš„åŒ…å«å…³ç³»å­˜åœ¨ä¸€ä¸€å¯¹åº”
>        - ä¾‹å¦‚ï¼Œæ¨¡å—`This.Is.Mymodule`\
           å¿…é¡»æ”¾ç½®åœ¨æºæ–‡ä»¶ç›®å½•ä¸‹çš„`This/Is/Mymodule`è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚

- `import Prelude`

  - æŠŠ`Prelude`æ¨¡å—å¯¹å¤–è¾“å‡ºçš„æ‰€æœ‰ç¨‹åºå…ƒç´ åŠ è½½åˆ°å½“å‰æ¨¡å—ä¸­

  - Haskell è§„å®šï¼š

    - è‹¥æ¨¡å—æºç ä¸­ä¸å­˜åœ¨`import Prelude`å£°æ˜ï¼Œåˆ™è¡¨æ˜å…¶ç¼ºçœå­˜åœ¨
      - æ•ˆæœï¼šä½ åœ¨ç¨‹åºä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨`Prelude`è¾“å‡ºçš„æ‰€æœ‰å…ƒç´ 

    - è‹¥æ¨¡å—æºç ä¸­å­˜åœ¨`import Prelude`æˆ–å…¶å˜ä½“ï¼Œåˆ™ä»`Prelude`ä¸­æŒ‰éœ€åŠ è½½å…ƒç´ 
      - ä¾‹å¦‚ï¼šå¦‚æœæ¨¡å—ä¸­å­˜åœ¨`import Prelude(Integer, (+), (-))`\
        åˆ™è¡¨æ˜åªéœ€æŠŠ`Prelude`å¯¹å¤–è¾“å‡ºçš„`ç±»å‹Integer`ã€`åŠ è¿ç®—ç¬¦`ã€`å‡è¿ç®—ç¬¦`ä¸‰ä¸ªå…ƒç´ åŠ è½½åˆ°å½“å‰æ¨¡å—ä¸­ï¼›Preludeå¯¹å¤–è¾“å‡ºçš„å…¶ä»–å…ƒç´ æ— éœ€åŠ è½½

      - ä¾‹å¦‚ï¼šä¸‹é¢çš„ Haskell æ¨¡å—å®šä¹‰ä¸åˆæ³•

        ```haskell
        module Main(main) where
        import Prelude(Integer, (+), (-))

        main :: IO ()
        main = do
          putStrLn "Hello, World!"
        ```
        åŸå› ï¼šè¯¥æ¨¡å—ä¸­å‡ºç°äº†ä¸¤ä¸ªæœªå®šä¹‰çš„å…ƒç´  `IO` `putStrLn`

- `main :: IO ()`

  - `main`å…ƒç´ çš„ç±»å‹æ˜¯ `IO ()`

    - `()` æ˜¯ä¸€ä¸ªç±»å‹ï¼Œç§°ä¸º `0 å…ƒç»„` (0-tuple) ç±»å‹

    - `IO` æ˜¯ä¸€ä¸ªç±»å‹æ„é€ å™¨ (type constructor)

    - `IO ()` æ˜¯ä¸€ä¸ªç±»å‹ï¼Œå…¶ä¸­å°è£…äº† IO è¿ç®—ï¼Œä¸”è¯¥è¿ç®—ä¼šè¿”å›ä¸€ä¸ª 0 å…ƒç»„

    > **å°å’Œå°šï¼š**
    >
    > - ä¸ºä»€ä¹ˆ`main`çš„ç±»å‹ä¸æ˜¯å‡½æ•°å‘¢ï¼Ÿ
    >
    >   C/C++/Java/Rustè¯­è¨€çš„mainéƒ½æ˜¯å‡½æ•°ã€‚
    >
    > **å”åƒ§ï¼š**
    >
    > - å› ä¸º`main`æœ¬æ¥å°±ä¸æ˜¯å‡½æ•°ã€‚
    >
    >   ä½ åœ¨å“ªæœ¬æ•°å­¦ä¹¦ä¸Šè§åˆ°è¿‡`main`è¿™æ ·çš„å‡½æ•°ï¼Ÿ
    >
    >   å“ªæœ‰å‡½æ•°ä¸€è¨€ä¸åˆå°±å‘æ§åˆ¶å°è¾“å‡ºå­—ç¬¦ä¸²çš„å‘¢ï¼Ÿ
    >
    > **å°å’Œå°šï¼š**
    >
    > - æ—¢ç„¶å¦‚æ­¤ï¼ŒC/C++ç­‰è¯­è¨€ä¸ºä»€ä¹ˆæŠŠmainä½œä¸ºå‡½æ•°å‘¢?
    >
    > **å”åƒ§ï¼š**
    >
    > - æˆ‘æƒ³ï¼Œå®ƒä»¬å¤§æ¦‚æ˜¯ä¸ºäº†è®©è‡ªå·±æ˜¾å¾—å¾ˆ NBã€‚
    >
    >   ä»»ä½•ä¸œè¥¿ï¼Œèƒ½å’Œæ•°å­¦æ²¾ä¸Šå…³ç³»ï¼Œå°±ä¼šæ˜¾å¾—é«˜å¤§ä¸Šäº†
    >
    >   ä¾‹å¦‚ï¼Œæœ‰çš„å…¬å¸ä¸¾åŠäº†å…¨çƒæ•°å­¦ç«èµ›ï¼Œåˆä¸å…¬å¸ƒæˆç»©ï¼Œ...

- `main = do`\
  &nbsp;&nbsp;`putStrLn "Hello, World!"`

  - å®šä¹‰äº†`main`ä¸­å°è£…çš„ IO è¿ç®—

  - è¿™ä¸ª IO è¿ç®—ä¸­ä»…åŒ…å«äº†ä¸€ä¸ª IO actionï¼Œå³ï¼šåœ¨æ§åˆ¶å°è¾“å‡ºä¸€ä¸²å­—ç¬¦

  - å¦‚æœä½ æ„¿æ„ï¼Œå¯ä»¥ç»§ç»­æ·»åŠ ä¸€ä¸ªIO action:\
    `putStrLn "Hello, World! AGAIN"`
    - æ³¨æ„ï¼šåº”ä¿æŒä¸ä¸Šä¸€è¡Œç›¸åŒçš„ç¼©è¿›

  > **å°å’Œå°šï¼š** `do`æ˜¯ä»€ä¹ˆæ¢—ï¼Ÿ
  >
  > **å”åƒ§ï¼š** ä¸€è¨€éš¾å°½å•Šï¼
  >
  > - ç®€è€Œè¨€ä¹‹ï¼š`do`æ˜¯ä¸€ç§è¯­æ³•ç³– (syntax sugar)
  >   - åœ¨å‡½æ•°çš„ä¸–ç•Œé‡Œï¼Œæ²¡æœ‰â€œé¡ºåºæ‰§è¡Œâ€è¿™ä¸ªæ¦‚å¿µ (è¿™å¥è¯å…¶å®æœ‰äº›å«ç³Š)
  >   - ä½†æ˜¯ï¼Œå¯ä»¥ç”¨ä¸€äº›æœºåˆ¶å»ä»¿çœŸâ€œé¡ºåºæ‰§è¡Œâ€
  >   - `do`çš„ä½œç”¨å°±æ˜¯æŠŠè¿™äº›æœºåˆ¶å°è£…èµ·æ¥ï¼Œè®©ç¨‹åºå…·æœ‰æ›´å¥½çš„æ˜“ç†è§£æ€§

- `putStrLn "Hello, World!"`

  - `putStrLn`æ˜¯`Prelude`æ¨¡å—è¾“å‡ºçš„ä¸€ä¸ªç¨‹åºå…ƒç´ ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š

     ```haskell
     putStrLn :: String -> IO ()
     putStrLn s = do putStr s
                     putStr "\n"
     ```

### 02 ä¸€ä¸ªå…·æœ‰æ›´å¤šäº¤äº’æ€§çš„ç¨‹åº

```haskell
module Main(main) where
import Prelude

main :: IO()
main = do
  putStrLn "Please input your name:"
  name <- getLine
  putStrLn $ "Hello, " ++ name
  putStrLn "Please input an integer:"
  str1 <- getLine
  putStrLn "Please input another integer:"
  str2 <- getLine
  let int1 = (read str1 :: Integer)
  let int2 = (read str2 :: Integer)
  putStrLn $ str1 ++ " + " ++ str2 ++ " = " ++ (show $ int1 + int2)
```
- `name <- getLine`

  `getLine`æ˜¯`Prelude`æ¨¡å—è¾“å‡ºçš„ä¸€ä¸ªå…ƒç´ ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š

  ```haskell
  getLine :: IO String
  getLine = do c <- getChar
               if c == '\n' then return "" else
                   do s <- getLine
                      return (c:s)
  ```

  ç¬¦å·`<-`æ˜¯ä¸`do`ç»‘å®šçš„ä¸€ç§è¯­æ³•ã€‚

  åœ¨è¿™è¡Œä»£ç ä¸­ï¼Œ`<-`çš„æ•ˆæœï¼Œæš‚æ—¶å¯ä»¥åšå¦‚ä¸‹ç†è§£ï¼š
  - æŠŠ`getLine`è¿”å›çš„`IO String`ç±»å‹çš„å€¼ä¸­çš„é‚£ä¸ª`String`ç±»å‹çš„å€¼èµ‹ç»™`name`

- `let int1 = (read str1 :: Integer)`

  è¿™ä¸€è¡Œä»£ç çœ‹æ¥æ—¢ç†Ÿæ‚‰åˆé™Œç”Ÿï¼š
  - æˆ‘ä»¬çœ‹åˆ°äº†ç†Ÿæ‚‰çš„`let`ï¼Œå´æ²¡æœ‰çœ‹åˆ°å®ƒçš„å¥½ä¼™ä¼´`in`
  - è¿™ä¸ª`let`å°±æ˜¯`let in`ä¸­çš„`let`ï¼Œç”¨äºå®šä¹‰åœ¨åé¢è¢«ä½¿ç”¨çš„å˜é‡ï¼›\
    ä½†æ˜¯ï¼Œ`in`è¢«è¯­æ³•ç³–éšè—äº† (æ—¶æœºåˆé€‚æ—¶ï¼Œå†ä»‹ç»ç»†èŠ‚)

  `read str1 :: Integer`
  - `read`æ˜¯`Prelude`è¾“å‡ºçš„ä¸€ä¸ªå‡½æ•°ï¼Œå…¶ç±»å‹å¤§çº¦æ˜¯`String -> a`
  - è¿™ä¸ªè¡¨è¾¾å¼çš„æ•ˆæœï¼šæŠŠä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢ä¸ºä¸€ä¸ªæ•´æ•°å€¼
  - åœ¨è°ƒç”¨`read`æ—¶ï¼Œè‹¥æ— æ³•ä»ä¸Šä¸‹æ–‡ä¸­æ¨æ–­å‡º`a`å¯¹åº”çš„å…·ä½“ç±»å‹ï¼Œ\
    åˆ™éœ€åœ¨å…¶åé¢æ”¾ç½® `:: X`ï¼Œæ˜¾å¼è¯´æ˜`a`çš„å…·ä½“ç±»å‹ä¸º`X`

- `show $ int1 + int2`
  - `show`æ˜¯`Prelude`è¾“å‡ºçš„ä¸€ä¸ªå‡½æ•°ï¼Œå…¶ç±»å‹å¤§çº¦æ˜¯`a -> String`
  - `show`çš„åŠŸèƒ½ï¼šæŠŠä¸€ä¸ªå€¼è½¬æ¢ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²

> **å”åƒ§ï¼š**
> - æŒæ¡äº†Haskell è¯­è¨€IOç›¸å…³çš„æ“ä½œï¼Œå†åŠ ä¸Šå‰é¢ä»‹ç»çš„çŸ¥è¯†ï¼Œä½ åº”è¯¥å¯ä»¥åšå¾ˆå¤šäº‹æƒ…äº†
> - éå¸¸é—æ†¾çš„æ˜¯ï¼Œè¿™äº›ç¨‹åºç›®å‰è¿˜ä¸èƒ½è¿è¡Œ
> - ä¸ç”¨å¤ªæ‹…å¿ƒï¼Œæƒ³è®©ç¨‹åºè¿è¡Œï¼Œåˆ†åˆ†é’Ÿçš„äº‹
>
> **å°å’Œå°šï¼š**
> - åˆ†åˆ†é’Ÿæ˜¯å¤šä¹…å‘¢ï¼Ÿ
>
> **å”åƒ§ï¼š** ğŸ˜… ... (ç”»å¤–éŸ³ï¼šæ°”æ°›çªç„¶æœ‰äº›å°´å°¬)

## Haskellç¨‹åºçš„ç¼–è¯‘ã€è¿è¡Œã€ç®¡ç†

> - å½“ä½ ç”¨è‡ªç„¶è¯­è¨€å†™äº†ä¸€æœ¬å°è¯´ï¼Œå¯ä»¥æŠŠå®ƒå‘è¡¨åœ¨äº’è”ç½‘ä¸Šï¼›\
>   ç„¶åï¼Œè¯»è€…ä»¬å°±å¯ä»¥é˜…è¯»è¿™æœ¬å°è¯´äº†
>
> - å½“ä½ ç”¨ Haskell è¯­è¨€å†™äº†ä¸€ä¸ªç¨‹åºï¼Œä¹Ÿå¯ä»¥æŠŠå®ƒå‘è¡¨åœ¨äº’è”ç½‘çš„æŸä¸ªä»£ç æ‰˜ç®¡ç½‘ç«™ä¸Šï¼›\
>   ç„¶åï¼Œç¨‹åºå‘˜ä»¬å°±å¯ä»¥é˜…è¯»è¿™ä¸ªç¨‹åºäº†
>
> - ä¸å°è¯´ä¸åŒçš„æ˜¯ï¼Œç¨‹åºè¿˜æœ‰å¦å¤–ä¸€ç±»è¯»è€…ï¼š**è®¡ç®—æœº**
>   - è®¡ç®—æœºéœ€è¦ç†è§£ç¨‹åºï¼Œå¹¶åœ¨å„ç±»ç¡¬ä»¶å’Œè½¯ä»¶èµ„æºçš„æ”¯æŒä¸‹ï¼Œæ‰§è¡Œç¨‹åºæ‰€è¡¨è¾¾çš„è®¡ç®—è¿‡ç¨‹
>
> - å¯¹äºç¨‹åºè®¾è®¡è¯­è¨€çš„å‘æ˜è€…ä»¬è€Œè¨€ï¼Œå®šä¹‰è¯­è¨€çš„è¯­æ³•å½¢å¼ï¼Œä»…ä»…æ˜¯ä¸‡é‡Œé•¿å¾çš„ç¬¬ä¸€æ­¥
>
> - ä¸ºäº†è®©ç¨‹åºèƒ½å¤Ÿåœ¨ç¡¬ä»¶ä¸Šè¿è¡Œï¼Œè¿˜éœ€æä¾›ä¸€ç³»åˆ—è½¯ä»¶æ”¯æ’‘å·¥å…·
>
> - è¿™äº›å·¥å…·åˆè¢«ç§°ä¸ºç¨‹åºè®¾è®¡è¯­è¨€çš„ **å·¥å…·é“¾** (toolchain)

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦ä»‹ç» Haskell è¯­è¨€å·¥å…·é“¾ä¸­çš„ä¸‰ä¸ªåŸºæœ¬å·¥å…·ï¼š
1. GHC (Glasgow Haskell Compiler)ï¼š
   - ä¸€ç§å¾—åˆ°å¹¿æ³›ä½¿ç”¨çš„Haskellè¯­è¨€ç¼–è¯‘å™¨ï¼Œ\
     èƒ½å¤ŸæŠŠåˆæ³•çš„Haskellç¨‹åºå˜æ¢è®¡ç®—æœºå¯æ‰§è¡Œçš„æœºå™¨æŒ‡ä»¤åºåˆ—

2. GHCiï¼š
   - Haskellç¨‹åºçš„ä¸€ç§äº¤äº’å¼ (interactive) è¿è¡Œç¯å¢ƒï¼›\
     ç¨‹åºå‘˜å¯åœ¨å…¶ä¸­è¾“å…¥ä»»æ„åˆæ³•çš„è¡¨è¾¾å¼ï¼Œç„¶å GHCi å¯¹è¡¨è¾¾å¼è¿›è¡Œæ±‚å€¼ï¼Œå¹¶è¾“å‡ºç»“æœ

3. Stackï¼š
   - ä¸€ç§å¸¸ç”¨çš„ Haskell è½¯ä»¶é¡¹ç›®æ„å»ºç®¡ç†å·¥å…·

### 00 Haskell å·¥å…·é“¾çš„å®‰è£…

è¿›å…¥é¡µé¢ `https://www.haskell.org/ghcup/`ã€‚

æŒ‰ç…§è¯´æ˜ï¼Œåœ¨è‡ªå·±çš„è®¡ç®—æœºä¸Šå®‰è£… Haskell å·¥å…·é“¾ã€‚
- å®‰è£…è¿‡ç¨‹ä¸­æ€»ä¼šé‡åˆ°å„ç§é—®é¢˜
- é‡åˆ°é—®é¢˜ï¼Œè«æ…Œå¼ ï¼Œä¸»åŠ¨å¯»æ±‚åŠ©æ•™æˆ–å…¶ä»–åŒå­¦çš„å¸®åŠ©

![ghcup](image/ghcup_homepage.png)

### 01 GHC çš„ä½¿ç”¨

> ghc æ˜¯ Haskell è¯­è¨€çš„ä¸€ç§ç¼–è¯‘å™¨ (compiler)\
> ä½œç”¨ï¼šæŠŠä¸€ä¸ªåˆæ³•çš„ Haskell ç¨‹åºè½¬æ¢/ç¼–è¯‘ä¸ºåœ¨å½“å‰è®¡ç®—æœºä¸Šå¯è¿è¡Œçš„äºŒè¿›åˆ¶ç¨‹åº

**Step 1ï¼š** æŠŠä¸‹é¢çš„ç¨‹åºä»£ç æ”¾ç½®åˆ°æŸä¸ªæ–‡ä»¶å¤¹ä¸‹çš„`Main.hs`æ–‡ä»¶ä¸­

```haskell
-- This is my first Haskell program
module Main(main) where
import Prelude

main :: IO ()
main = do
  putStrLn "Hello, World!"
```
- ç¬¬ä¸€è¡Œä¸ºç¨‹åº **æ³¨é‡Š** (comment)

  -   æ³¨é‡Šå°±æ˜¯å¯¹ç¨‹åºåšçš„ä¸€äº›è¯´æ˜ï¼Œä¸ä¼šæ”¹å˜ç¨‹åºçš„è¿è¡Œæ—¶è¡Œä¸º

- Haskell çš„æ³¨é‡Šåˆ†ä¸ºä¸¤ç±»ï¼š

  1. **å•è¡Œæ³¨é‡Šï¼š** ä»¥ä¸¤ä¸ªè¿ç»­è¿å­—ç¬¦ `--` å¼€å§‹çš„ä¸€è¡Œæ–‡å­—

  2. **å¤šè¡Œæ³¨é‡Šï¼š** ä»¥ `{-` å¼€å§‹ã€ä»¥ `-}` ç»“æŸçš„æ‰€æœ‰æ–‡å­—

**Step 2ï¼š** æ‰“å¼€ç»ˆç«¯ (Terminal) åº”ç”¨ï¼ŒæŠŠå½“å‰ç›®å½•è®¾ç½®ä¸º`Main.hs`æ‰€åœ¨çš„æ–‡ä»¶å¤¹

**Step 3ï¼š** ç¼–è¯‘ç¨‹åº (å³ï¼šåœ¨ç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤`ghc Main.hs`ï¼Œå¹¶å›è½¦)

**Step 4ï¼š** è¿è¡Œç¨‹åº (å³ï¼šåœ¨ç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤`./Main`ï¼Œå¹¶å›è½¦)

![ghc](image/ghc_screenshot.png)

> - å¯¹äºç¬¬ä¸€æ¬¡æ¥è§¦ç¨‹åºè®¾è®¡è¯­è¨€çš„åŒå­¦ï¼Œè¿™æ˜¯ä¸€ä¸ªå…·æœ‰å†å²æ„ä¹‰çš„æ—¶åˆ»ã€‚
>
>   **è¿™æ˜¯äººç±»çš„ä¸€å¤§æ­¥ï¼Œå´åªæ˜¯ä¸ªä½“çš„ä¸€å°æ­¥ã€‚**
>
> - è®¸å¤šå¹´ä¹‹åï¼Œé¢å¯¹æœªåæ¹–è¾¹éšé£æ‘‡æ›³çš„å‚æŸ³ï¼Œ\
>   ä½ å°†ä¼šå›æƒ³èµ·ï¼Œè´¹å°½åƒè¾›ä¸‡è‹¦ç»ˆäºæˆåŠŸè¿è¡Œè¿™ä¸ªæ— èŠç¨‹åºçš„é‚£ä¸ªé¥è¿œçš„å¤œæ™šã€‚

> **åŠ¨æ‰‹ç»ƒä¸€ç»ƒ 01**
>
> è¯·æŠŠå‰æ–‡ä»‹ç»çš„é‚£ä¸ªæ›´æœ‰äº¤äº’æ€§çš„ Haskell ç¨‹åºï¼Œç”¨ ghc å‘½ä»¤ç¼–è¯‘ä¸ºå¯æ‰§è¡Œç¨‹åºã€‚\
> ç„¶åè¿è¡Œè¯¥ç¨‹åºï¼Œè§‚å¯Ÿç¨‹åºå’Œä½ çš„äº¤äº’è¿‡ç¨‹ã€‚

å…³äº ghc çš„è¯¦ç»†ä½¿ç”¨è¯´æ˜ï¼Œå¯è®¿é—®å…¶å®˜æ–¹ç½‘ç«™ï¼šhttps://www.haskell.org/ghc/
- æ²¡äº‹ä¸è¦æ‰“å¼€è¿™ä¸ªé“¾æ¥ï¼›æ‰“å¼€äº†ä¹Ÿçœ‹ä¸æ‡‚ã€‚\
  ä½ éœ€è¦åœ¨å­¦ä¹ è¿‡ç¼–è¯‘åŸç†ç›¸å…³çš„çŸ¥è¯†åï¼Œå†æ¥çœ‹ä¸€çœ‹ã€‚


### 02 GHCi çš„ä½¿ç”¨

> ghci æ˜¯ Haskell ç¨‹åºçš„ä¸€ç§äº¤äº’å¼è¿è¡Œç¯å¢ƒã€‚\
> ghci é»˜è®¤åŠ è½½`Prelude`æ¨¡å—ï¼›å› æ­¤ï¼Œå¯ç›´æ¥ä½¿ç”¨è¯¥æ¨¡å—è¾“å‡ºçš„å…ƒç´ 

![ghci-enter](image/ghci_enter.png)

ä½ å¯ä»¥åœ¨å…¶ä¸­è¾“å‡ºåˆæ³•çš„ Haskell è¡¨è¾¾å¼ï¼›ghci ä¼šè¾“å‡ºæ±‚å€¼ç»“æœã€‚

![ghci-expression](image/ghci_expression.png)

ghci ä¸­çš„å¸¸ç”¨å‘½ä»¤ï¼š

- `:?`   åˆ—å‡ºghciæ”¯æŒçš„æ‰€æœ‰å‘½ä»¤

- `:quit` æˆ– `:q`   é€€å‡ºå½“å‰ghciç¯å¢ƒ

- `:load <æ¨¡å—æ–‡ä»¶å>`   æŠŠä¸€ä¸ªæŒ‡å®šçš„æ¨¡å—åŠ è½½åˆ°å½“å‰ç¯å¢ƒä¸­

- `:reload`	  é‡æ–°åŠ è½½é‚£äº›å·²ç»åŠ è½½çš„æ¨¡å— (è¿™äº›æ¨¡å—å¯èƒ½è¢«ä¿®æ”¹äº†)

> **`:load` å‘½ä»¤ä½¿ç”¨ç¤ºä¾‹ï¼š**
>  - æ‰“å¼€ç»ˆç«¯ (Terminal) åº”ç”¨ï¼ŒæŠŠå½“å‰ç›®å½•è®¾ç½®ä¸º`Main.hs`æ‰€åœ¨çš„æ–‡ä»¶å¤¹
>
>  ![ghci-load](image/ghci_load.png)

> **åŠ¨æ‰‹ç»ƒä¸€ç»ƒ 02**
>
> 1. æŠŠå‰æ–‡ä»‹ç»çš„å¿«é€Ÿæ’åºå‡½æ•°`qsort`å°è£…åœ¨ä¸€ä¸ª Haskell æ¨¡å—ä¸­ï¼›
> 2. åœ¨ ghci ä¸­åŠ è½½è¿™ä¸ªæ¨¡å—ï¼›
> 3. åœ¨ ghci ä¸­å¯¹`qsort`å‡½æ•°çš„æ­£ç¡®æ€§è¿›è¡Œæµ‹è¯•
>    - å³ï¼šæŠŠè¿™ä¸ªå‡½æ•°ä½œç”¨åˆ°è‹¥å¹²åºåˆ—æ•°æ®ä¸Šï¼Œè§‚å¯Ÿå‡½æ•°çš„è¿”å›å€¼æ˜¯å¦ç¬¦åˆé¢„æœŸ
>

### 03 Stack çš„ä½¿ç”¨

> stack æ˜¯ä¸€ç§é¢å‘ Haskell ç¨‹åºå¼€å‘çš„æ„å»ºç®¡ç†å·¥å…·ã€‚\
> å…¶ç®¡ç†å†…å®¹è¦†ç›–ï¼šä»£ç ç»„ç»‡æ–¹å¼ã€ç¼–è¯‘å™¨ç‰ˆæœ¬åŠç¼–è¯‘å‚æ•°ã€å¤–éƒ¨ä¾èµ–å…³ç³»ã€æµ‹è¯•ç­‰ã€‚

ghcã€ghci é€‚åˆåšä¸€äº›å°æ‰“å°é—¹çš„äº‹æƒ…ï¼š
- ä¾‹å¦‚ï¼Œå­¦ä¹  Haskell è¯­è¨€ã€ç¼–å†™ä¸€ä¸ªå°è§„æ¨¡çš„ Haskell ç¨‹åºç­‰
- å…¶ä¸­ï¼Œghci å¯ä»¥ä½œä¸ºä¸€ç§å…¥é—¨çº§çš„ç¨‹åºè°ƒè¯•ç¯å¢ƒ

çœŸå®çš„è½¯ä»¶å¼€å‘æ˜¯ä¸€ç§é¢å‘ç¾¤ä½“çš„æ™ºåŠ›å¯†é›†å‹æ´»åŠ¨ã€‚

> **å°å’Œå°šï¼š**
> - æˆ‘å°±ä¸€ä¸ªäººå¼€å‘ä¸€ä¸ªå¤æ‚çš„è½¯ä»¶åº”ç”¨ï¼Œä¸å¯ä»¥å—ï¼Ÿ
>
> **å”åƒ§ï¼š**
> - å¯ä»¥ï¼Œä¸€ä¸ªå»ºç­‘å·¥äººä¹Ÿå¯ä»¥ç‹¬ç«‹å»ºé€ ä¸€æ ‹æ‘©å¤©å¤§æ¥¼ï¼›åªè¦ç»™ä»–è¶³å¤Ÿçš„æ—¶é—´ã€‚
>
> - ç¾¤ä½“è½¯ä»¶å¼€å‘è¿˜é¢ä¸´å„ç§å¤æ‚çš„ç®¡ç†é—®é¢˜
>   - åŒ…æ‹¬ï¼šäººåŠ›èµ„æºç®¡ç†ã€éœ€æ±‚ç®¡ç†ã€è½¯ä»¶åˆ¶å“ç®¡ç†ã€ç¼–è¯‘ç¯å¢ƒç®¡ç†ã€å¼€å‘è¿›åº¦ç®¡ç†ç­‰
>
> - **å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨**ï¼šéœ€è¦é‡‡ç”¨åˆé€‚çš„å·¥å…·åº”å¯¹è¿™äº›é—®é¢˜

ä¸‹é¢ï¼Œæˆ‘ä»¬åŸºäºstack çš„å®˜æ–¹ä½¿ç”¨è¯´æ˜ï¼Œå¯¹å®ƒè¿›è¡Œç®€è¦çš„ä»‹ç»ã€‚

**`stack new` å‘½ä»¤**

- ä½¿ç”¨`stack new`å‘½ä»¤ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªå…·æœ‰ç‰¹å®šåç§°çš„è½¯ä»¶å¼€å‘é¡¹ç›®ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª**åŒ…**(package)
- Packageè¿™ä¸ªæ¦‚å¿µåœ¨è¯­è¨€è§„èŒƒä¸­å¹¶ä¸å­˜åœ¨ï¼Œä½†åœ¨å®è·µä¸­å¾—åˆ°å¹¿æ³›åº”ç”¨ã€‚

  åœ¨é€»è¾‘ä¸Šï¼Œä¸€ä¸ª package åŒ…å«è‹¥å¹²ç›¸å…³çš„ Haskell æ¨¡å—ã€‚
  - ä¾‹å¦‚ï¼šå¯ä»¥æŠŠä¸€ä¸ªå®Œæ•´çš„Haskellç¨‹åºæ‰“åŒ…ä¸ºä¸€ä¸ªpackageï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªMainæ¨¡å—ã€è‹¥å¹²ä¸ªè¢«Mainæ¨¡å—åŠ è½½çš„è‡ªå®šä¹‰æ¨¡å—ã€ä»¥åŠç›¸å…³çš„æµ‹è¯•æ¨¡å—ã€‚

- ä¸€ä¸ª package å…·æœ‰ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„åç§°

  - package çš„åç§°ç”±è‹¥å¹²ä¸ªå•è¯é€šè¿‡è¿å­—ç¬¦`-`è¿ç»“åœ¨ä¸€èµ·
  - æ¯ä¸ªå•è¯ç”±è‹¥å¹²å­—æ¯æˆ–æ•°å­—ç»„æˆï¼Œä¸”è‡³å°‘åŒ…å«ä¸€ä¸ªå­—æ¯

å¦‚æœè¦åœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªåç§°ä¸º`foo`çš„é¡¹ç›®ï¼Œå¯ä»¥è¿™ä¹ˆåšï¼š
1. æ‰“å¼€ç»ˆç«¯åº”ç”¨ï¼Œå°†å½“å‰ç›®å½•è®¾å®šä¸ºé¡¹ç›®æ‰€åœ¨çš„æ–‡ä»¶å¤¹
2. è¿è¡Œå¦‚ä¸‹å‘½ä»¤ (ç¡®ä¿ä½ çš„è®¡ç®—æœºå¤„äºè”ç½‘çŠ¶æ€)

   `stack new foo`

å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œå½“å‰æ–‡ä»¶å¤¹ä¸‹ä¼šå­˜åœ¨ä¸€ä¸ªåä¸º`foo`çš„æ–‡ä»¶å¤¹
- `foo`é¡¹ç›®çš„æ‰€æœ‰ä¿¡æ¯éƒ½è¢«æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­

ä½¿ç”¨`cd foo`å‘½ä»¤è¿›å…¥è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œå¯ä»¥çœ‹åˆ°å…¶ä¸­å­˜åœ¨çš„ä¿¡æ¯ï¼š

> ```shell
> .
> â”œâ”€â”€ CHANGELOG.md
> â”œâ”€â”€ LICENSE
> â”œâ”€â”€ README.md
> â”œâ”€â”€ Setup.hs
> â”œâ”€â”€ app
> â”‚   â””â”€â”€ Main.hs
> â”œâ”€â”€ foo.cabal
> â”œâ”€â”€ package.yaml
> â”œâ”€â”€ src
> â”‚Â Â  â””â”€â”€ Lib.hs
> â”œâ”€â”€ stack.yaml
> â”œâ”€â”€ stack.yaml.lock
> â””â”€â”€ test
>     â””â”€â”€ Spec.hs
> ```

**`stack build` å‘½ä»¤**

- åœ¨ç»ˆç«¯çš„`foo`ç›®å½•ä¸‹è¾“å…¥å‘½ä»¤`stack build`å¯¹`foo`é¡¹ç›®è¿›è¡Œæ„å»º

**`stack exec` å‘½ä»¤**

- åœ¨ç»ˆç«¯çš„`foo`ç›®å½•ä¸‹è¾“å…¥å‘½ä»¤`stack exec foo-exe`ï¼Œè¿è¡Œå½“å‰é¡¹ç›®

  - å¦‚æœä½ è§‰å¾—`foo-exe`è¿™ä¸ªåå­—ä¸å¥½ï¼Œå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹æˆå¦å¤–ä¸€ä¸ª

**`stack test` å‘½ä»¤**

- åœ¨ç»ˆç«¯çš„`foo`ç›®å½•ä¸‹è¾“å…¥å‘½ä»¤`stack test`ï¼Œå¯ä»¥è§¦å‘å¯¹å½“å‰é¡¹ç›®çš„æµ‹è¯•

  - stack å·²ç»å¸®åŠ©æˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªç©ºçš„æµ‹è¯•ç¨‹åº

  - æˆ‘ä»¬éœ€è¦æ ¹æ®é¡¹ç›®çš„å®é™…å†…å®¹å‘å…¶ä¸­å¡«å†™ç›¸åº”çš„æµ‹è¯•ä»£ç 

    - ä¾‹å¦‚ï¼Œå¦‚æœä½ è‡ªå·±ç¼–å†™äº†ä¸€ä¸ªæ’åºå‡½æ•°ï¼Œä¸ºäº†ç¡®ä¿åŠŸèƒ½çš„æ­£ç¡®æ€§ï¼Œä½ éœ€è¦åœ¨è‹¥å¹²ç§å…·æœ‰ä»£è¡¨æ€§çš„æ•°æ®ä¸Šæµ‹è¯•æ’åºå‡½æ•°çš„è¾“å‡ºæ˜¯å¦ç¬¦åˆä½ çš„é¢„æœŸã€‚

    - åªè¦æŠŠè¿™äº›æµ‹è¯•æ•°æ®æŒ‰ç…§è§„å®šçš„æ–¹å¼å†™åœ¨ç‰¹å®šçš„æ–‡ä»¶ä¸­ï¼Œ`stack test`å‘½ä»¤å°±ä¼šè‡ªåŠ¨æ‰§è¡Œå¯¹åº”çš„æµ‹è¯•æ´»åŠ¨ï¼Œå¹¶ç»™å‡ºæµ‹è¯•ç»“æœ.

#### stack åœ¨`foo`é¡¹ç›®ä¸­åˆ›å»ºçš„æ–‡ä»¶

- **ä¸‰ä¸ªæ–‡ä»¶ï¼š** `LICENSE` / `README.md` / `CHANGELOG.md`

  1. `LICENSE`   å£°æ˜å½“å‰é¡¹ç›®ç‰ˆæƒç›¸å…³çš„ä¿¡æ¯

  2. `README.md`   å¯¹å½“å‰é¡¹ç›®çš„ç®€è¦è¯´æ˜ã€

  3. `CHANGELOG.md`   è®°å½•é¡¹ç›®åœ¨ä¸åŒç‰ˆæœ¬ä¸­å‘ç”Ÿçš„å˜æ›´æƒ…å†µ

  - è¿™ä¸‰ä¸ªæ–‡ä»¶ä¸ä¼šå‚ä¸åˆ°ç¼–è¯‘æ´»åŠ¨ä¸­ï¼Œä¸ä¼šå¯¹æ„å»ºè¿‡ç¨‹äº§ç”Ÿå½±å“

- **ä¸¤ä¸ªæ–‡ä»¶ï¼š** `helloworld.cabal` / `Setup.hs`

  - è¿™æ˜¯æ›´åº•å±‚çš„æ„å»ºå·¥å…·`cabal`ç›¸å…³çš„ä¸¤ä¸ªæ–‡ä»¶ï¼›æ— éœ€å…³æ³¨

- **ä¸€ä¸ªæ–‡ä»¶ï¼š** `stack.yaml`ã€‚å…¶ä¸­è®°å½•äº†ä¸¤æ¡ä¿¡æ¯ï¼š

  ```yaml
  packages:
  - .
  ```
  - å«ä¹‰ï¼šå½“å‰é¡¹ç›®ä¸­åŒ…å«ä¸€ä¸ª packageï¼Œå®ƒå°±å­˜åœ¨äº`stack.yaml`æ‰€åœ¨çš„æ–‡ä»¶å¤¹ä¸­

  ```yaml
  snapshot:
    url: https://raw.githubusercontent.com/commercialhaskell/stackage-snapshots/master/lts/24/4.yaml
  ```
  - å«ä¹‰ï¼šä¸€ä¸ª URLï¼ŒæŒ‡å‘äº’è”ç½‘ä¸Šçš„ä¸€ä¸ª yaml æ–‡ä»¶ï¼Œå…¶ä¸­æŒ‡æ˜äº†å½“å‰é¡¹ç›®ä½¿ç”¨çš„ GHC ç‰ˆæœ¬ä»¥åŠä¸€äº›å¯ç”¨çš„å¤–éƒ¨ package

- **ä¸€ä¸ªæ–‡ä»¶ï¼š** `package.yaml`

  ```yaml
  name:                foo
  version:             0.1.0.0
  github:              "githubuser/foo"
  license:             BSD-3-Clause
  author:              "Author name here"
  maintainer:          "example@example.com"
  copyright:           "2025 Author name here"

  extra-source-files:
  - README.md
  - CHANGELOG.md

  # Metadata used when publishing your package
  # synopsis:            Short description of your package
  # category:            Web

  # To avoid duplicated efforts in documentation and dealing with the
  # complications of embedding Haddock markup inside cabal files, it is
  # common to point users to the README.md file.
  description:         Please see the README on GitHub at <https://github.com/githubuser/foo#readme>

  dependencies:
  - base >= 4.7 && < 5

  ghc-options:
  - -Wall
  - -Wcompat
  - -Widentities
  - -Wincomplete-record-updates
  - -Wincomplete-uni-patterns
  - -Wmissing-export-lists
  - -Wmissing-home-modules
  - -Wpartial-fields
  - -Wredundant-constraints

  library:
    source-dirs: src    # å½“å‰é¡¹ç›®çš„ lib æ–‡ä»¶æ”¾åœ¨ src æ–‡ä»¶å¤¹ä¸­

  executables:
    foo-exe:    # stack exec å‘½ä»¤åè·Ÿçš„é‚£ä¸ªåå­—ï¼›å¯ä»¥è¢«ä¿®æ”¹ä¸ºå…¶ä»–åç§°
      main:                Main.hs    # main å…ƒç´ å®šä¹‰åœ¨ Main.hs ä¸­
      source-dirs:         app        # foo-exe çš„æºæ–‡ä»¶æ”¾åœ¨ app æ–‡ä»¶å¤¹ä¸­
      ghc-options:
      - -threaded
      - -rtsopts
      - -with-rtsopts=-N
      dependencies:
      - foo

  tests:
    foo-test:
      main:                Spec.hs
      source-dirs:         test
      ghc-options:
      - -threaded
      - -rtsopts
      - -with-rtsopts=-N
      dependencies:
      - foo
  ```

- **ä¸‰ä¸ª hs æ–‡ä»¶ï¼š**

  1. `app/Main.hs`

     ```haskell
     module Main (main) where

     import Lib

     main :: IO ()
     main = someFunc
     ```
  2. `src/Lib.hs`

     ```haskell
     module Lib
         ( someFunc
         ) where

     someFunc :: IO ()
     someFunc = putStrLn "someFunc"
     ```
  3. `test/Spec.hs`

     ```haskell
     main :: IO ()
     main = putStrLn "Test suite not yet implemented"
     ```

> **å”åƒ§ï¼š** æˆ‘æƒ³ï¼Œä½ å¤§æ¦‚æ˜ç™½`stack new foo`åšäº†ä»€ä¹ˆå§ï¼Ÿ
>
> - å®ƒå¸®æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª Haskell ç¨‹åºçš„éª¨æ¶ä»¥åŠç¼–è¯‘å’Œè¿è¡Œç¯å¢ƒã€‚
>
>   - æ‰€æœ‰çš„è¿™ä¸€åˆ‡ï¼Œstack éƒ½è¿›è¡Œäº†å¾ˆå¥½çš„å°è£…ï¼Œä½¿å¾—æˆ‘ä»¬åªéœ€è¦ä½¿ç”¨stackæä¾›çš„å‡ ä¸ªå‘½ä»¤ï¼Œå°±èƒ½å¯¹ä¸€ä¸ªè½¯ä»¶å¼€å‘é¡¹ç›®è¿›è¡Œä¾¿æ·çš„ç®¡ç†

> **åŠ¨æ‰‹ç»ƒä¸€ç»ƒ 03**
>
> è¯·ä½¿ç”¨stack åˆ›å»ºä¸€ä¸ªåä¸ºqsort çš„é¡¹ç›®ã€‚ç„¶åï¼š
> 1. åœ¨`src/Lib.hs`ä¸­æ·»åŠ å¹¶è¾“å‡ºå‰é¢ä»‹ç»çš„`qsort`å‡½æ•°ï¼›
> 2. åœ¨`app/Main.hs`ä¸­åŠ è½½`Lib`æ¨¡å—ï¼Œ\
>    ç„¶åï¼Œæ‰¾å‡ ä¸ªå¾…æ’åºçš„æ•°æ®ï¼Œç”¨`qsort`å‡½æ•°å¯¹å®ƒä»¬è¿›è¡Œæ’åºï¼Œæ‰“å°å‡ºæ’åºçš„ç»“æœ

#### åŸºäº stack çš„ package ç®¡ç†

- æœ‰äººè¯´ï¼Œä»–ç«™åœ¨äº†å·¨äººçš„è‚©è†€ä¸Šï¼Œçœ‹åˆ°äº†å¾ˆè¿œçš„åœ°æ–¹

  æ­¤è¨€ç¡®å®ä¸è™šï¼Œåœ¨è½¯ä»¶å¼€å‘ä¸­ä¹Ÿæ˜¯å¦‚æ­¤

- åœ¨çœŸå®çš„è½¯ä»¶å¼€å‘é¡¹ç›®ä¸­ï¼Œå¾ˆå°‘æœ‰å¼€å‘è€…ä»é›¶å¼€å§‹ç¼–å†™æ‰€æœ‰çš„è½¯ä»¶ä»£ç 

  å¼€å‘è€…æ€»æ˜¯å°½å¯èƒ½å¤ç”¨å…¶ä»–å¼€å‘è€…å·²ç»å¼€å‘å®Œæˆçš„åŠŸèƒ½æ¨¡å—ã€‚

  - ä¾‹å¦‚ï¼Œå‰é¢æˆ‘ä»¬çœ‹åˆ°çš„`Prelude`æ¨¡å—å°±æ˜¯ Haskell æ ‡å‡†åº“æä¾›çš„ä¸€ä¸ªæ¨¡å—ã€‚
  - Haskell æ ‡å‡†åº“è¿˜æä¾›äº†å¾ˆå¤šå…¶ä»–æ¨¡å—ï¼›å…·ä½“å‚è§Haskellè¯­è¨€è§„èŒƒ
  - Haskell ä¹Ÿæä¾›äº† import è¯­å¥æ¥æ”¯æŒå¯¹å…¶ä»–æ¨¡å—çš„å¤ç”¨

- ä½†æ˜¯ï¼Œäº‹æƒ…å¹¶æ²¡æœ‰åˆ°æ­¤ç»“æŸ

- **è½¯ä»¶å¼€å‘è€…ç¾¤ä½“æ˜¯ä¸€ä¸ªä¹äºåˆ†äº«çš„ç¾¤ä½“**

  - æœ‰å¾ˆå¤šç¨‹åºå‘˜è€—è´¹äº†å¤§é‡çš„ç²¾åŠ›ï¼Œå¼€å‘å‡ºå¾ˆå¤šé«˜è´¨é‡çš„è½¯ä»¶æ¨¡å—ï¼Œç„¶åæŠŠè¿™äº›æ¨¡å—æ”¾åœ¨äº’è”ç½‘ï¼Œä¾›å…¶ä»–å¼€å‘è€…å…è´¹ä½¿ç”¨

  - ç„¶åï¼Œå…¶ä»–å¼€å‘è€…åœ¨å‰äººå¼€å‘çš„æ¨¡å—çš„åŸºç¡€ä¸Šåˆå¼€å‘å‡ºæ–°çš„æ¨¡å—ï¼Œå¹¶å…±äº«åˆ°å¼€å‘è€…ç¾¤ä½“ä¸­

  - é•¿æ­¤ä»¥å¾€ï¼Œå°±å½¢æˆäº†ä¸€ç§æ¬£æ¬£å‘è£çš„ç”Ÿæ€ç³»ç»Ÿ

  - åœ¨è¿™ä¸ªç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œä¸°å¯Œå¤šæ ·çš„è½¯ä»¶æ¨¡å—ä¸æ–­æ¶Œç°ï¼ŒæŒç»­æ¼”åŒ–ï¼Œå°±åƒè‡ªç„¶ç•Œç”Ÿæ€ç³»ç»Ÿæ‰€å±•ç°å‡ºçš„ç‰©ç§çš„å¤šæ ·æ€§å’ŒæŒç»­æ¼”åŒ–é‚£æ ·

- è¿™ç§ä¹äºåˆ†äº«çš„ç‰¹ç‚¹åœ¨ Haskell å¼€å‘è€…ç¾¤ä½“ä¸­ä¹Ÿæ˜¯å­˜åœ¨çš„ï¼Œä¹Ÿåœ¨æ­¤åŸºç¡€ä¸Šå½¢æˆäº†æ¬£æ¬£å‘è£çš„ç”Ÿæ€

- åœ¨è¿™ä¸ªç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œå¼€å‘è€…åˆ†äº«å·¥ä½œæˆæœçš„åŸºæœ¬å•ä½æ˜¯ **package**ï¼Œ
  - ä¹Ÿå³ï¼šä¸€ä¸ªå¼€å‘è€…æŠŠä¸€ç»„ç›¸å…³çš„Haskellæ¨¡å—å°è£…ä¸ºä¸€ä¸ªpackageï¼Œç„¶åå°†å…¶å‘å¸ƒåˆ°äº’è”ç½‘ä¸Š

> **å°å’Œå°šï¼š**
> - åˆ†äº«å·¥ä½œæˆæœçš„åŸºæœ¬å•ä½ä»€ä¹ˆä¸èƒ½æ˜¯æ¨¡å—å‘¢ï¼Ÿ
>
> **å”åƒ§ï¼š**
> - å…¶å®ï¼Œä½ æŠŠä¸€ä¸ªæ¨¡å—å•ç‹¬å°è£…ä¸ºä¸€ä¸ªpackageä¹Ÿæ˜¯å¯ä»¥çš„
>
> - åœ¨æ›´ä¸€èˆ¬çš„æ„ä¹‰ä¸Šï¼Œä¸ä»¥æ¨¡å—ä½œåŸºæœ¬å‘å¸ƒå•ä½çš„ä¸»è¦åŸå› å¦‚ä¸‹ï¼š
>   1. æ¨¡å—ä¸å­˜åœ¨ç‰ˆæœ¬çš„æ¦‚å¿µ
>      - åœ¨è½¯ä»¶å¼€å‘ç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œæ¼”åŒ–æ˜¯ä¸€ç§å¸¸æ€
>      - ç¼ºå¤±äº†ç‰ˆæœ¬çš„æ¦‚å¿µï¼Œä½¿å¾—æˆ‘ä»¬ä¸èƒ½å¯¹åŒä¸€ä¸ªæ¨¡å—çš„ä¸åŒç‰ˆæœ¬è¿›è¡Œæœ‰æ•ˆç®¡ç†
>
>   2. åœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œæ¨¡å—è¿‡äºç»†ç²’åº¦
>      - å¦‚æœè¦å¯¹å¤–å‘å¸ƒä¸€ä¸ªå¤æ‚çš„Haskellåº”ç”¨ç¨‹åºï¼Œä»¥æ¨¡å—ä¸ºåŸºæœ¬å•å…ƒæ˜¾ç„¶ä¸åˆé€‚
>
>   3. å½“ä½ å¯¹å¤–å‘å¸ƒä¸€ä¸ªæ¨¡å—æ—¶ï¼Œä¸ºäº†ä½¿å¾—å…¶ä»–å¼€å‘è€…å¯¹è¯¥æ¨¡å—çš„è´¨é‡å…·æœ‰è¶³å¤Ÿçš„ä¿¡å¿ƒï¼Œä½ å¯èƒ½è¿˜éœ€è¦å°†è¯¥æ¨¡å—çš„æµ‹è¯•æ•°æ®å’Œç¨‹åºä¸€èµ·å¯¹å¤–å‘å¸ƒã€‚æ­¤æ—¶ï¼Œå°†ä¸€ä¸ªæ¨¡å—ä»¥åŠé™„å¸¦çš„æµ‹è¯•æ¨¡å—æ‰“åŒ…ä¸€ä¸ª packageï¼Œå…·åˆç†æ€§.

- ä½¿ç”¨`stack new`åˆ›å»ºçš„é¡¹ç›®ï¼Œå…¶ä¸­å°±åŒ…å«äº†ä¸€æˆ–å¤šä¸ª package

  - è¿™äº› package çš„ä¿¡æ¯è®°å½•åœ¨`stack.yaml`æ–‡ä»¶çš„`packages`é…ç½®é¡¹ä¸­
  - ä¾‹å¦‚ï¼Œåœ¨`foo`é¡¹ç›®ä¸­ï¼Œpackages ä¸‹é¢åªåŒ…å«ä¸€ä¸ªå€¼ï¼Œå³ï¼šç‚¹ç¬¦å· `.`
    - è¿™è¡¨æ˜ï¼Œåœ¨`foo`é¡¹ç›®çš„æ ¹ç›®å½•ä¸­å­˜åœ¨ä¸€ä¸ª package

- åœ¨ stack é¡¹ç›®ä¸­ï¼Œæ¯ä¸€ä¸ª package çš„ç®¡ç†ä¿¡æ¯è®°å½•åœ¨ä¸€ä¸ªåä¸º`package.yaml`çš„æ–‡ä»¶ä¸­.

  - è¯¥æ–‡ä»¶åŒ…å«ä¸€ä¸ªé‡è¦çš„é…ç½®é¡¹ **`dependencies`**

    - å®ƒè®°å½•äº†å½“å‰ package ä¾èµ–çš„æ‰€æœ‰å…¶ä»– package çš„åç§°ä¸ç‰ˆæœ¬ä¿¡æ¯

    - ä¾‹å¦‚ï¼Œåœ¨`foo`é¡¹ç›®åŒ…å«çš„å”¯ä¸€ä¸€ä¸ª package çš„`package.yaml`æ–‡ä»¶ä¸­ï¼Œé…ç½®é¡¹ `dependencies` ä¿¡æ¯å¦‚ä¸‹ï¼š

      ```yaml
      dependencies:
      - base >= 4.7 && < 5
      ```
      - å«ä¹‰ï¼šå½“å‰ package ä¾èµ–äºä¸€ä¸ªåç§°ä¸º`base`çš„ packageï¼Œä¸”è¦æ±‚`base`çš„ç‰ˆæœ¬å·è½åœ¨åŒºé—´ï¼»4.7, 5ï¼‰ä¸­

      > ä¸€ä¸ªé‡è¦é—®é¢˜ï¼š**å¦‚ä½•è·å¾—è¿™ä¸ªåç§°ä¸ºbaseçš„ç‰¹å®šç‰ˆæœ¬çš„ package å‘¢ï¼Ÿ**

- Haskell ç¤¾åŒºç»´æŠ¤äº†ä¸€ä¸ªåœ¨çº¿çš„ package ä»“åº“ï¼Œå¹¶å°†å…¶å‘½åä¸º Hackage

  `https://hackage.haskell.org/`

  ä»»ä½•ä¸€ä¸ªå¼€å‘è€…éƒ½å¯ä»¥å‘è¿™ä¸ªä»“åº“ä¸­å‘å¸ƒè‡ªå·±å¼€å‘çš„ packageï¼Œä¹Ÿå¯ä»¥ä»è¿™ä¸ªä»“åº“ä¸­ä¸‹è½½ç‰¹å®šåç§°å’Œç‰¹å®šç‰ˆæœ¬çš„ package

- ä½ å¯ä»¥åœ¨ Hackage ä¸­æœç´¢åç§°ä¸º`base`çš„ package

  åœ¨ç»“æœé¡µé¢ä¸Šï¼Œå¯ä»¥çœ‹åˆ°`base`çš„æ‰€æœ‰ç‰ˆæœ¬ï¼Œå’Œæ¯ä¸€ç‰ˆæœ¬åŒ…å«çš„æ‰€æœ‰æ¨¡å—

  åœ¨é•¿é•¿çš„æ¨¡å—åˆ—è¡¨ä¸­ï¼Œä¼šçœ‹åˆ°ä¸¤ä¸ªç†Ÿæ‚‰çš„åå­—ï¼š`Prelude`å’Œ`Numeric.Natural`

  - å› ä¸º`base`åŒ…å«äº†è¿™ä¸¤ä¸ªæ¨¡å—ï¼Œä¸”å½“å‰çš„é¡¹ç›®ä¾èµ–äº`base`ï¼Œæ‰€ä»¥ï¼Œåœ¨å½“å‰é¡¹ç›®ä¸­ï¼Œå°±å¯ä»¥ä½¿ç”¨ `import`è¯­å¥åŠ è½½è¿™ä¸¤ä¸ªæ¨¡å—äº†

- ä½ å¯ä»¥åœ¨`package.yaml`æ–‡ä»¶çš„`dependencies`é…ç½®é¡¹ä¸­æ·»åŠ æ›´å¤šçš„ package åç§°ä»¥åŠå¯¹åº”çš„ç‰ˆæœ¬éœ€æ±‚

  ç„¶åï¼Œä½¿ç”¨`stack build`å‘½ä»¤ï¼Œstack å°±ä¼šè‡ªåŠ¨åˆ° Hackage ä»“åº“ä¸­ä¸‹è½½å¯¹åº” package

  å¦‚æœä½ ä¸ç›¸ä¿¡ï¼Œå°±è¯•è¯•ä¸‹é¢çš„ç»ƒä¹ å§

> **åŠ¨æ‰‹ç»ƒä¸€ç»ƒ 04**
>
> Hackage ä¸­æœ‰ä¸€ä¸ªåç§°ä¸º`random`çš„ packageï¼š
> - å…¶ä¸­åŒ…å«ä¸€ä¸ªåç§°ä¸º`system.Random`çš„æ¨¡å—ï¼›å…¶ä¸­å®šä¹‰äº†ä¸€ä¸ªåç§°`randomIO`çš„å…ƒç´ ã€‚
>
> åœ¨ do åé¢çš„ä»£ç å—ä¸­ï¼Œä½¿ç”¨`rnd <- randomIO :: IO Int`ï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ªéšæœºç”Ÿæˆçš„æ•´æ•°ã€‚
>
>
> è¯·å®Œæˆå¦‚ä¸‹äº‹æƒ…ï¼š
>
> 1. ä½¿ç”¨ stack åˆ›å»ºä¸€ä¸ªåç§°ä¸º`random-num`çš„é¡¹ç›®
>
> 2. åœ¨ package.yaml æ–‡ä»¶çš„`dependencies`ä¸‹æ·»åŠ ä¸€ä¸ªå€¼ï¼š`random == 1.2.0`
>    - å«ä¹‰ï¼šå½“å‰ package ä¾èµ–ä¸€ä¸ªåç§°`random`ã€ç‰ˆæœ¬`1.2.0`çš„ package
>    - åœ¨Macçš„Mç³»åˆ—èŠ¯ç‰‡ä¸Šï¼Œå¯èƒ½éœ€è¦æŠŠè¿™ä¸ªå€¼ä¿®æ”¹ä¸º `random >= 1.2 && < 2`
>
> 3. åœ¨å½“å‰é¡¹ç›®ä¸­å®ç° â€œå‘ç»ˆç«¯æ‰“å°å‡ºä¸€ä¸ªéšæœºæ•°â€ çš„åŠŸèƒ½
>
> è¯·ç‰¹åˆ«æ³¨æ„ï¼Œ**å½“ä½ ä½¿ç”¨`stack new`å‘½ä»¤åï¼Œç»ˆç«¯çš„è¾“å‡ºä¿¡æ¯**ã€‚

- éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œåœ¨ä¸»æµçš„ç¨‹åºè®¾è®¡è¯­è¨€å¼€å‘ç¤¾åŒºä¸­ï¼Œéƒ½å­˜åœ¨ç±»ä¼¼çš„packageç®¡ç†æ–¹å¼

  - å³ï¼šä¸€ä¸ªè¢«å¼€å‘è€…å¹¿æ³›è®¤åŒçš„ package ä»“åº“ã€ä¸€ä¸ªé…å¥—çš„æ„å»ºç®¡ç†å·¥å…·ã€‚

    - è¿™æ˜¯åœ¨äº’è”ç½‘æ—¶ä»£å½¢æˆçš„ä¸€ç§ç¾¤ä½“è½¯ä»¶å¼€å‘æ¨¡å¼ï¼Œå¯èƒ½ä¼šé™ªä¼´ä½ å¾ˆé•¿çš„æ—¶é—´ã€‚
    - é€‰æ‹©ä¸€ä¸ªå¼€å‘è€…ç¤¾åŒºï¼Œé€‰æ‹©ä¸€ä¸ªæœ‰ä»·å€¼çš„è½¯ä»¶å¼€å‘é¡¹ç›®ï¼ŒåŠªåŠ›æˆä¸ºé¡¹ç›®çš„æ ¸å¿ƒè´¡çŒ®è€…ï¼Œä½ ä¼šæ”¶è·å¾ˆå¤šå¾ˆå¤šã€‚

- å…³äº stackï¼Œæš‚ä¸”è®²åˆ°è¿™é‡Œå§ã€‚æœ‰å…´è¶£çš„åŒå­¦å¯è‡ªè¡Œé˜…è¯»ç›¸å…³ææ–™

## Haskell ç¨‹åºçš„ä¹¦å†™

### Haskell ç¨‹åºçš„ â€œä¹¦å†™é£æ ¼â€

å¯¹äºå­¦ä¹ è¿‡C / C++ / Javaè¯­è¨€çš„åŒå­¦è€Œè¨€ï¼Œå¯èƒ½ä¼šè§‰å¾—Haskellç¨‹åºçš„ä¹¦å†™æœ‰äº›å¥‡æ€ª

- åœ¨ä¼ ç»Ÿè¯­è¨€ä¸­ï¼Œæºç¨‹åºä¸­ä¼šå‡ºç°å¤§é‡çš„åˆ†å· `;` å’ŒèŠ±æ‹¬å·å¯¹ `ï½› ... ï½`

  - å‰è€…çš„ä½œç”¨ï¼šä½œä¸ºä¸€æ¡è¯­å¥çš„ç»ˆç»“ç¬¦
  - åè€…çš„ä½œç”¨ï¼šæŠŠå‡ æ¡è¯­å¥å°è£…ä¸ºä¸€ä¸ªä»£ç å— (Code Block)

- ä½†æ˜¯ï¼Œåœ¨å‰é¢å‡ºç°çš„ Haskell ç¨‹åºä¸­ï¼Œä»æ¥æ²¡æœ‰çœ‹åˆ°è¿‡èŠ±æ‹¬å·å’Œåˆ†å·ã€‚

å…¶å®ï¼Œ**ä½ è¯¯è§£ Haskell äº†**ã€‚

- Haskell è§„å®šï¼Œåœ¨ `where` / `let` / `do` / `of` è¿™å››ä¸ªå…³é”®è¯åï¼Œéœ€è¦æ”¾ç½®ä¸€ä¸ªä»£ç å—

- åœ¨ä»£ç å—çš„ä¹¦å†™ä¸Šï¼ŒHaskellæä¾›äº†ä¸¤ç§ä¹¦å†™é£æ ¼ï¼š

  1. **Layout-sensitive** (æ’å¸ƒæ— å…³)

     - åˆ©ç”¨ä»£ç è¡Œçš„ç¼©è¿›è¡¨ç¤ºè¯­å¥çš„ç»“æŸæˆ–ä»£ç å—çš„ç»“æŸ

  2. **Layout-insensitive** (æ’å¸ƒç›¸å…³)

     - åˆ©ç”¨åˆ†å·è¡¨ç¤ºè¯­å¥çš„ç»“æŸï¼Œåˆ©ç”¨ä¸€å¯¹èŠ±æ‹¬å·å½¢æˆä¸€ä¸ªä»£ç å—

- ä¸‹é¢æ˜¯å‰æ–‡å‡ºç°çš„ä¸€ä¸ªé‡‡ç”¨ layout-sensitive é£æ ¼ä¹¦å†™çš„æºç¨‹åº

  ```haskell
  module Main(main) where
  import Prelude

  main :: IO()
  main = do
    putStrLn "Please input your name:"
    name <- getLine
    putStrLn $ "Hello, " ++ name
    putStrLn "Please input an integer:"
    str1 <- getLine
    putStrLn "Please input another integer:"
    str2 <- getLine
    let int1 = (read str1 :: Integer)
    let int2 = (read str2 :: Integer)
    putStrLn $ str1 ++ " + " ++ str2 ++ " = " ++ (show $ int1 + int2)
  ```
  å¯¹åº”çš„ layout-insensitive ç¨‹åºå¦‚ä¸‹ï¼š

  ```haskell
  module Main(main) where {
    import Prelude;

    main :: IO();
    main = do {
      putStrLn "Please input your name:";
      name <- getLine;
      putStrLn $ "Hello, " ++ name;
      putStrLn "Please input an integer:";
      str1 <- getLine;
      putStrLn "Please input another integer:";
      str2 <- getLine;
      let { int1 = (read str1 :: Integer); };
      let { int2 = (read str2 :: Integer); };
      putStrLn $ str1 ++ " + " ++ str2 ++ " = " ++ (show $ int1 + int2);
    }
  }
  ```

  > **å”åƒ§ï¼š**
  > - ä½ æ›´å–œæ¬¢å“ªä¸€ç§é£æ ¼å‘¢ï¼Ÿ
  > - ç”±ç¹å…¥ç®€æ˜“ï¼Œç”±ç®€è¿”ç¹éš¾ï¼›å›ä¸å»å’¯ï¼
  >
  > **å°å’Œå°šï¼š**
  > - åœ¨é‡‡ç”¨ layout-sensitive é£æ ¼ä¹¦å†™ç¨‹åºæ—¶ï¼Œå¦‚ä½•ç¡®å®šä¸€è¡Œä»£ç çš„ç¼©è¿›é•¿åº¦ï¼Ÿ
  >
  > **å”åƒ§ï¼š** è®°ä½ä¸‰æ¡æœ¦èƒ§çš„å‡†åˆ™ï¼š
  >
  > 1. ç›¸åŒç¼©è¿› => å¼€å§‹ä¸€æ¡æ–°è¯­å¥
  >
  > 2. æ›´å¤šç¼©è¿› => ç»§ç»­ä¸Šä¸€æ¡è¯­å¥
  >
  > 3. æ›´å°‘ç¼©è¿› => ç»“æŸä¸€ä¸ªä»£ç å—

### Haskell ç¨‹åºçš„ â€œä¹¦å†™æ–¹å¼â€

Haskell æä¾›äº†ä¸¤ç§æºç¨‹åºçš„ä¹¦å†™æ–¹å¼ï¼š

1. æ–‡ä»¶æ‰©å±•åä¸º`hs`çš„ä¹¦å†™æ–¹å¼

   æŠŠ layout-insensitive/sensitive é£æ ¼çš„ç¨‹åºæ”¾ç½®åœ¨æ‰©å±•åä¸º`hs`çš„æ–‡ä»¶ä¸­

2. æ–‡ä»¶æ‰©å±•åä¸º `lhs` çš„ä¹¦å†™æ–¹å¼

   æ³¨é‡Š ä¸ å…¶ä»–ä»£ç  çš„åœ°ä½å‘ç”Ÿäº†å˜åŒ–:

   - ä¹¦å†™æ³¨é‡Šæ—¶ï¼Œ**ä¸éœ€è¦ä½¿ç”¨** å‰ç¼€ `--` æˆ–èµ·å§‹/ç»ˆæ­¢å­—ç¬¦ä¸² `ï½›-` / `-ï½`ï¼›
   - ä¹¦å†™å…¶ä»–ä»£ç æ—¶ï¼Œ**æ¯ä¸€è¡Œå¼€å§‹å¿…é¡»æ·»åŠ ** ç¬¦å· `>`

<table>

<caption> <code> hs </code> / <code> lhs </code> å¯¹æ¯” </caption>

<thead><tr>
  <th> hs  </th>
  <th> lhs </th>
</tr></thead>

<tbody>

<tr>
  <td>

  ```haskell
  -- This is my first Haskell program
  -- Stored in file: Main.hs

  module Main(main) where

  main :: IO ()
  main = do
    putStrLn "Hello, World!"

  -- This is the end.
  ```
  </td>
  <td>

  ```haskell
  This is my first Haskell program
  Stored in file: Main.lhs

  > module Main(main) where
  >
  > main :: I0 ()
  > main = do
  >     putstrun "Hello, World!"

  This is the end.
  ```
  </td>
</tr>
</table>

- æ³¨æ„ï¼šlhs æ–‡ä»¶çš„ä¹¦å†™å­˜åœ¨ä¸€ä¸ªç¡¬æ€§çš„è¦æ±‚

  - ä»¥ç¬¦å· `>` å¼€å§‹çš„ä»£ç è¡Œ ä¸ æ³¨é‡Š ä¹‹é—´ è‡³å°‘å­˜åœ¨ä¸€ä¸ªç©ºè¡Œ

> **å°å’Œå°šï¼š**
> - ä¸ºä»€ä¹ˆè¦å‘æ˜lhsè¿™ç§ä¹¦å†™æ–¹å¼å‘¢ï¼Ÿ
>
> **å”åƒ§ï¼š**
> - è¿™ä¸ªé—®é¢˜ï¼Œä½ è‡ªå·±æ…¢æ…¢ä½“ä¼šå§ï¼›ä¸é‡è¦ã€‚

## æœ¬ç« ä½œä¸š

> <div class="warning">
>
> **ä½œä¸š 01**
>
> å…³äºé€»è¾‘ä¸ (and) å‡½æ•°ï¼Œä½ è¿˜èƒ½æƒ³åˆ°å…¶ä»–å®šä¹‰æ–¹å¼å—ï¼Ÿ\
> è¯·ç”¨ Haskell è¯­è¨€å†™å‡ºè‡³å°‘å…¶ä»–ä¸‰ç§å®šä¹‰æ–¹å¼ã€‚
>
> </div>

> <div class="warning">
>
> **ä½œä¸š 02**
>
> è¯·ç”¨ç›®å‰ä»‹ç»çš„ Haskell è¯­è¨€çŸ¥è¯†ï¼Œç»™å‡ºå‡½æ•°`div`çš„ä¸€ç§æˆ–å¤šç§å®šä¹‰ã€‚
> - div :: Integer -> Integer -> Integer
>
> è¯´æ˜ï¼š
> - ä¸ç”¨å…³æ³¨æ•ˆç‡
> - ä¸ç”¨å…³æ³¨ç¬¬äºŒä¸ªå‚æ•°ä¸º 0 çš„æƒ…å†µ
> - å¦‚æœä½ è®¤ä¸ºè¿™ä¸ªé—®é¢˜æ— è§£æˆ–å¾ˆéš¾ï¼Œè¯·ç»™å‡ºå¿…è¦çš„è¯´æ˜
>   - ä¸ºä»€ä¹ˆæ— è§£ï¼Ÿ æˆ–è€…ï¼Œå›°éš¾åœ¨å“ªé‡Œï¼Ÿ
>
> </div>

> <div class="warning">
>
> **ä½œä¸š 03**
>
> å…³äºé˜¶ä¹˜å‡½æ•°ï¼Œä½ è¿˜èƒ½æƒ³åˆ°å…¶ä»–å®šä¹‰æ–¹å¼å—ï¼Ÿ\
> è¯·åˆ†åˆ«ä½¿ç”¨ â€œguarded equationsâ€ å’Œ â€œconditional expressionâ€ å†™å‡ºé˜¶ä¹˜å‡½æ•°çš„å®šä¹‰ã€‚
>
> </div>

> <div class="warning">
>
> **ä½œä¸š 04**
>
> å°æ˜åŒå­¦å­¦ä¹ äº†è¿™ä¹ˆå¤š Haskell è¯­è¨€çš„çŸ¥è¯†åï¼Œæ„Ÿè§‰å¾ˆç´¯ã€‚\
> äºæ˜¯ï¼Œä»–æƒ³ç”¨ Haskell è¯­è¨€ç¼–å†™ä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡Œæ¸¸æˆè®©è‡ªå·±æ”¾æ¾ä¸€ä¸‹ã€‚
>
> è¿™ä¸ªæ¸¸æˆæè¿°å¦‚ä¸‹ï¼š
> 1. ç³»ç»Ÿéšæœºç”Ÿæˆä¸€ä¸ª 1ï½100 ä¹‹é—´çš„æ•´æ•°ï¼Œè®°ä¸º `x`
> 2. åœ¨å‘½ä»¤è¡Œä¸­æç¤ºç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ•´æ•°
> 3. æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„æ•´æ•°ï¼Œè®°ä¸º `xâ€™`
> 4. å¦‚æœ `xâ€™ < x`ï¼Œæç¤ºç”¨æˆ·ä»–/å¥¹è¾“å…¥çš„å€¼æ¯”çœŸå®å€¼å°ï¼Œè·³è½¬åˆ° `2`
> 5. å¦‚æœ `xâ€™ > x`ï¼Œæç¤ºç”¨æˆ·ä»–/å¥¹è¾“å…¥çš„å€¼æ¯”çœŸå®å€¼å¤§ï¼Œè·³è½¬åˆ° `2`
> 6. å¦‚æœ `xâ€™ == x`ï¼Œæç¤ºç”¨æˆ·ä»–/å¥¹æˆåŠŸäº†ï¼Œæ¸¸æˆç»“æŸ
>
> å°æ˜åŒå­¦å¤ªç´¯äº†ï¼Œæ‰€ä»¥æƒ³è¯·ä½ å¸®ä»–å†™ä¸€ä¸ªè¿™æ ·çš„ç¨‹åºã€‚ä½ è§‰å¾—è¿™ä¸ªäº‹æƒ…å¯è¡Œå—ï¼Ÿ
> 1. è¯·å°è¯•ç¼–å†™ä¸€ä¸ªè¿™æ ·çš„ç¨‹åº
> 2. å¦‚æœä½ å‘ç°è¿™ä¸ªäº‹æƒ…æœ‰å›°éš¾ï¼Œè¯·å‘Šè¯‰æˆ‘ä»¬ï¼š
>    - ä½ çš„æ±‚è§£æ€è·¯æ˜¯ä»€ä¹ˆ (å¤šç§æ€è·¯ä¹Ÿå¯ä»¥) ï¼Ÿ
>    - åœ¨æŒ‰ç…§ä¸€ä¸ªæ€è·¯å‰è¿›çš„è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº†ä»€ä¹ˆå›°éš¾ï¼Œä½¿å¾—ä½ æ— æ³•ç»§ç»­èµ°ä¸‹å»
>
> </div>
